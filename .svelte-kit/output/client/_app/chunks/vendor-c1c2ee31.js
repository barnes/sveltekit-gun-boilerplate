var xt=Object.defineProperty;var ht=Object.getOwnPropertySymbols;var St=Object.prototype.hasOwnProperty,At=Object.prototype.propertyIsEnumerable;var pt=(g,i,$)=>i in g?xt(g,i,{enumerable:!0,configurable:!0,writable:!0,value:$}):g[i]=$,F=(g,i)=>{for(var $ in i||(i={}))St.call(i,$)&&pt(g,$,i[$]);if(ht)for(var $ of ht(i))At.call(i,$)&&pt(g,$,i[$]);return g};function W(){}function jt(g,i){for(const $ in i)g[$]=i[$];return g}function yt(g){return g()}function dt(){return Object.create(null)}function L(g){g.forEach(yt)}function Tt(g){return typeof g=="function"}function $t(g,i){return g!=g?i==i:g!==i||g&&typeof g=="object"||typeof g=="function"}function Et(g){return Object.keys(g).length===0}function Ot(g,...i){if(g==null)return W;const $=g.subscribe(...i);return $.unsubscribe?()=>$.unsubscribe():$}function Yt(g,i,$){g.$$.on_destroy.push(Ot(i,$))}function Qt(g,i,$,w){if(g){const t=vt(g,i,$,w);return g[0](t)}}function vt(g,i,$,w){return g[1]&&w?jt($.ctx.slice(),g[1](w(i))):$.ctx}function Zt(g,i,$,w){if(g[2]&&w){const t=g[2](w($));if(i.dirty===void 0)return t;if(typeof t=="object"){const r=[],e=Math.max(i.dirty.length,t.length);for(let o=0;o<e;o+=1)r[o]=i.dirty[o]|t[o];return r}return i.dirty|t}return i.dirty}function te(g,i,$,w,t,r){if(t){const e=vt(i,$,w,r);g.p(e,t)}}function ee(g){if(g.ctx.length>32){const i=[],$=g.ctx.length/32;for(let w=0;w<$;w++)i[w]=-1;return i}return-1}let Y=!1;function Dt(){Y=!0}function Nt(){Y=!1}function Gt(g,i,$,w){for(;g<i;){const t=g+(i-g>>1);$(t)<=w?g=t+1:i=t}return g}function Bt(g){if(g.hydrate_init)return;g.hydrate_init=!0;let i=g.childNodes;if(g.nodeName==="HEAD"){const u=[];for(let n=0;n<i.length;n++){const h=i[n];h.claim_order!==void 0&&u.push(h)}i=u}const $=new Int32Array(i.length+1),w=new Int32Array(i.length);$[0]=-1;let t=0;for(let u=0;u<i.length;u++){const n=i[u].claim_order,h=(t>0&&i[$[t]].claim_order<=n?t+1:Gt(1,t,v=>i[$[v]].claim_order,n))-1;w[u]=$[h]+1;const l=h+1;$[l]=u,t=Math.max(l,t)}const r=[],e=[];let o=i.length-1;for(let u=$[t]+1;u!=0;u=w[u-1]){for(r.push(i[u-1]);o>=u;o--)e.push(i[o]);o--}for(;o>=0;o--)e.push(i[o]);r.reverse(),e.sort((u,n)=>u.claim_order-n.claim_order);for(let u=0,n=0;u<e.length;u++){for(;n<r.length&&e[u].claim_order>=r[n].claim_order;)n++;const h=n<r.length?r[n]:null;g.insertBefore(e[u],h)}}function Ct(g,i){if(Y){for(Bt(g),(g.actual_end_child===void 0||g.actual_end_child!==null&&g.actual_end_child.parentElement!==g)&&(g.actual_end_child=g.firstChild);g.actual_end_child!==null&&g.actual_end_child.claim_order===void 0;)g.actual_end_child=g.actual_end_child.nextSibling;i!==g.actual_end_child?(i.claim_order!==void 0||i.parentNode!==g)&&g.insertBefore(i,g.actual_end_child):g.actual_end_child=i.nextSibling}else(i.parentNode!==g||i.nextSibling!==null)&&g.appendChild(i)}function ne(g,i,$){Y&&!$?Ct(g,i):(i.parentNode!==g||i.nextSibling!=$)&&g.insertBefore(i,$||null)}function It(g){g.parentNode.removeChild(g)}function Ut(g){return document.createElement(g)}function nt(g){return document.createTextNode(g)}function re(){return nt(" ")}function ie(){return nt("")}function oe(g,i,$,w){return g.addEventListener(i,$,w),()=>g.removeEventListener(i,$,w)}function ue(g,i,$){$==null?g.removeAttribute(i):g.getAttribute(i)!==$&&g.setAttribute(i,$)}function Pt(g){return Array.from(g.childNodes)}function Jt(g){g.claim_info===void 0&&(g.claim_info={last_index:0,total_claimed:0})}function wt(g,i,$,w,t=!1){Jt(g);const r=(()=>{for(let e=g.claim_info.last_index;e<g.length;e++){const o=g[e];if(i(o)){const u=$(o);return u===void 0?g.splice(e,1):g[e]=u,t||(g.claim_info.last_index=e),o}}for(let e=g.claim_info.last_index-1;e>=0;e--){const o=g[e];if(i(o)){const u=$(o);return u===void 0?g.splice(e,1):g[e]=u,t?u===void 0&&g.claim_info.last_index--:g.claim_info.last_index=e,o}}return w()})();return r.claim_order=g.claim_info.total_claimed,g.claim_info.total_claimed+=1,r}function Mt(g,i,$,w){return wt(g,t=>t.nodeName===i,t=>{const r=[];for(let e=0;e<t.attributes.length;e++){const o=t.attributes[e];$[o.name]||r.push(o.name)}r.forEach(e=>t.removeAttribute(e))},()=>w(i))}function ae(g,i,$){return Mt(g,i,$,Ut)}function Kt(g,i){return wt(g,$=>$.nodeType===3,$=>{const w=""+i;if($.data.startsWith(w)){if($.data.length!==w.length)return $.splitText(w.length)}else $.data=w},()=>nt(i),!0)}function fe(g){return Kt(g," ")}function se(g,i){i=""+i,g.wholeText!==i&&(g.data=i)}function ce(g,i){g.value=i==null?"":i}function le(g,i,$,w){g.style.setProperty(i,$,w?"important":"")}let Q;function Z(g){Q=g}function rt(){if(!Q)throw new Error("Function called outside component initialization");return Q}function he(g){rt().$$.on_mount.push(g)}function pe(g){rt().$$.after_update.push(g)}function ye(g,i){rt().$$.context.set(g,i)}const X=[],bt=[],tt=[],gt=[],Ht=Promise.resolve();let it=!1;function Rt(){it||(it=!0,Ht.then(_t))}function ot(g){tt.push(g)}let ut=!1;const at=new Set;function _t(){if(!ut){ut=!0;do{for(let g=0;g<X.length;g+=1){const i=X[g];Z(i),Ft(i.$$)}for(Z(null),X.length=0;bt.length;)bt.pop()();for(let g=0;g<tt.length;g+=1){const i=tt[g];at.has(i)||(at.add(i),i())}tt.length=0}while(X.length);for(;gt.length;)gt.pop()();it=!1,ut=!1,at.clear()}}function Ft(g){if(g.fragment!==null){g.update(),L(g.before_update);const i=g.dirty;g.dirty=[-1],g.fragment&&g.fragment.p(g.ctx,i),g.after_update.forEach(ot)}}const et=new Set;let R;function de(){R={r:0,c:[],p:R}}function ve(){R.r||L(R.c),R=R.p}function mt(g,i){g&&g.i&&(et.delete(g),g.i(i))}function we(g,i,$,w){if(g&&g.o){if(et.has(g))return;et.add(g),R.c.push(()=>{et.delete(g),w&&($&&g.d(1),w())}),g.o(i)}}function be(g,i){g.d(1),i.delete(g.key)}function ge(g,i,$,w,t,r,e,o,u,n,h,l){let v=g.length,d=r.length,p=v;const f={};for(;p--;)f[g[p].key]=p;const m=[],A=new Map,c=new Map;for(p=d;p--;){const S=l(t,r,p),T=$(S);let j=e.get(T);j?w&&j.p(S,i):(j=n(T,S),j.c()),A.set(T,m[p]=j),T in f&&c.set(T,Math.abs(p-f[T]))}const a=new Set,s=new Set;function _(S){mt(S,1),S.m(o,h),e.set(S.key,S),h=S.first,d--}for(;v&&d;){const S=m[d-1],T=g[v-1],j=S.key,O=T.key;S===T?(h=S.first,v--,d--):A.has(O)?!e.has(j)||a.has(j)?_(S):s.has(O)?v--:c.get(j)>c.get(O)?(s.add(j),_(S)):(a.add(O),v--):(u(T,e),v--)}for(;v--;){const S=g[v];A.has(S.key)||u(S,e)}for(;d;)_(m[d-1]);return m}function _e(g,i){const $={},w={},t={$$scope:1};let r=g.length;for(;r--;){const e=g[r],o=i[r];if(o){for(const u in e)u in o||(w[u]=1);for(const u in o)t[u]||($[u]=o[u],t[u]=1);g[r]=o}else for(const u in e)t[u]=1}for(const e in w)e in $||($[e]=void 0);return $}function me(g){return typeof g=="object"&&g!==null?g:{}}function ke(g){g&&g.c()}function xe(g,i){g&&g.l(i)}function Wt(g,i,$,w){const{fragment:t,on_mount:r,on_destroy:e,after_update:o}=g.$$;t&&t.m(i,$),w||ot(()=>{const u=r.map(yt).filter(Tt);e?e.push(...u):L(u),g.$$.on_mount=[]}),o.forEach(ot)}function qt(g,i){const $=g.$$;$.fragment!==null&&(L($.on_destroy),$.fragment&&$.fragment.d(i),$.on_destroy=$.fragment=null,$.ctx=[])}function Lt(g,i){g.$$.dirty[0]===-1&&(X.push(g),Rt(),g.$$.dirty.fill(0)),g.$$.dirty[i/31|0]|=1<<i%31}function Se(g,i,$,w,t,r,e,o=[-1]){const u=Q;Z(g);const n=g.$$={fragment:null,ctx:null,props:r,update:W,not_equal:t,bound:dt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(i.context||(u?u.$$.context:[])),callbacks:dt(),dirty:o,skip_bound:!1,root:i.target||u.$$.root};e&&e(n.root);let h=!1;if(n.ctx=$?$(g,i.props||{},(l,v,...d)=>{const p=d.length?d[0]:v;return n.ctx&&t(n.ctx[l],n.ctx[l]=p)&&(!n.skip_bound&&n.bound[l]&&n.bound[l](p),h&&Lt(g,l)),v}):[],n.update(),h=!0,L(n.before_update),n.fragment=w?w(n.ctx):!1,i.target){if(i.hydrate){Dt();const l=Pt(i.target);n.fragment&&n.fragment.l(l),l.forEach(It)}else n.fragment&&n.fragment.c();i.intro&&mt(g.$$.fragment),Wt(g,i.target,i.anchor,i.customElement),Nt(),_t()}Z(u)}class Ae{$destroy(){qt(this,1),this.$destroy=W}$on(i,$){const w=this.$$.callbacks[i]||(this.$$.callbacks[i]=[]);return w.push($),()=>{const t=w.indexOf($);t!==-1&&w.splice(t,1)}}$set(i){this.$$set&&!Et(i)&&(this.$$.skip_bound=!0,this.$$set(i),this.$$.skip_bound=!1)}}const q=[];function je(g,i=W){let $;const w=new Set;function t(o){if($t(g,o)&&(g=o,$)){const u=!q.length;for(const n of w)n[1](),q.push(n,g);if(u){for(let n=0;n<q.length;n+=2)q[n][0](q[n+1]);q.length=0}}}function r(o){t(o(g))}function e(o,u=W){const n=[o,u];return w.add(n),w.size===1&&($=i(t)||W),o(g),()=>{w.delete(n),w.size===0&&($(),$=null)}}return{set:t,update:r,subscribe:e}}var ft=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function st(g){throw new Error('Could not dynamically require "'+g+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var kt={exports:{}};(function(g){(function(){function i(w,t){return t?st(w):w.slice?i[r(w)]:function(e,o){w(e={exports:{}}),i[r(o)]=e.exports};function r(e){return e.split("/").slice(-1).toString().replace(".js","")}}var $=g;i(function(w){String.random=function(r,e){var o="";for(r=r||24,e=e||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";r-- >0;)o+=e.charAt(Math.floor(Math.random()*e.length));return o},String.match=function(r,e){var o,u;return typeof r!="string"?!1:(typeof e=="string"&&(e={"=":e}),e=e||{},o=e["="]||e["*"]||e[">"]||e["<"],r===o?!0:u!==e["="]?!1:(o=e["*"]||e[">"],r.slice(0,(o||"").length)===o?!0:u!==e["*"]?!1:u!==e[">"]&&u!==e["<"]?r>=e[">"]&&r<=e["<"]:u!==e[">"]&&r>=e[">"]||u!==e["<"]&&r<=e["<"]))},String.hash=function(r,e){if(typeof r=="string"){if(e=e||0,!r.length)return e;for(var o=0,u=r.length,n;o<u;++o)n=r.charCodeAt(o),e=(e<<5)-e+n,e|=0;return e}};var t=Object.prototype.hasOwnProperty;Object.plain=function(r){return r?r instanceof Object&&r.constructor===Object||Object.prototype.toString.call(r).match(/^\[object (\w+)\]$/)[1]==="Object":!1},Object.empty=function(r,e){for(var o in r)if(t.call(r,o)&&(!e||e.indexOf(o)==-1))return!1;return!0},Object.keys=Object.keys||function(r){var e=[];for(var o in r)t.call(r,o)&&e.push(o);return e},function(){var r,e=setTimeout,o=0,u=0,n=typeof setImmediate!=""+r&&setImmediate||e;e.poll=e.poll||function(h){if(1>=+new Date-o&&u++<3333){h();return}n(function(){o=+new Date,h()},u=0)}}(),function(){var r=setTimeout,e=r.turn=r.turn||function(v){o.push(v)==1&&u(l)},o=e.s=[],u=r.poll,n=0,h,l=function(){(h=o[n++])&&h(),(n==o.length||n==99)&&(o=e.s=o.slice(n),n=0),o.length&&u(l)}}(),function(){var r,e=setTimeout,o=e.turn;(e.each=e.each||function(u,n,h,l){l=l||9,function v(d,p,f){if(p=(d=(u||[]).splice(0,l)).length){for(var m=0;m<p&&r===(f=n(d[m]));m++);if(r===f){o(v);return}}h&&h(f)}()})()}()})(i,"./shim"),i(function(w){w.exports=function t(r,e,o){if(!r)return{to:t};var u,n=typeof e=="function",r=(this.tag||(this.tag={}))[r]||n&&(this.tag[r]={tag:r,to:t._={next:function(l){var v;(v=this.to)&&v.next(l)}}});if(n){var h={off:t.off||(t.off=function(){if(this.next===t._.next)return!0;this===this.the.last&&(this.the.last=this.back),this.to.back=this.back,this.next=t._.next,this.back.to=this.to,this.the.last===this.the&&delete this.on.tag[this.the.tag]}),to:t._,next:e,the:r,on:this,as:o};return(h.back=r.last||r).to=h,r.last=h}return(r=r.to)&&u!==e&&r.next(e),r}})(i,"./onto"),i(function(w){i("./shim"),w.exports=function(t){return t===void 0?!1:t===null?!0:t===1/0||t!==t?!1:typeof t=="string"||typeof t=="boolean"||typeof t=="number"?!0:t&&typeof(t["#"]||0)=="string"&&Object.empty(t,["#"])?t["#"]:!1}})(i,"./valid"),i(function(w){i("./shim");function t(){var h=+new Date;return u<h?(e=0,u=h+t.drift):u=h+(e+=1)/o+t.drift}t.drift=0;var r=-1/0,e=0,o=999,u=r,n;t.is=function(h,l,v){var d=l&&h&&h._&&h._[">"]||v;if(!!d)return typeof(d=d[l])=="number"?d:r},t.ify=function(h,l,v,d,p){(h=h||{})._=h._||{},p&&(h._["#"]=p);var f=h._[">"]||(h._[">"]={});return n!==l&&l!=="_"&&(typeof v=="number"&&(f[l]=v),n!==d&&(h[l]=d)),h},w.exports=t})(i,"./state"),i(function(w){i("./shim");function t(r){var e={s:{}},o=e.s;r=r||{max:999,age:1e3*9},e.check=function(n){return o[n]?u(n):!1};var u=e.track=function(n){var h=o[n]||(o[n]={});return h.was=e.now=+new Date,e.to||(e.to=setTimeout(e.drop,r.age+9)),h};return e.drop=function(n){e.to=null,e.now=+new Date;var h=Object.keys(o);console.STAT&&console.STAT(e.now,+new Date-e.now,"dup drop keys"),setTimeout.each(h,function(l){var v=o[l];v&&(n||r.age)>e.now-v.was||delete o[l]},0,99)},e}w.exports=t})(i,"./dup"),i(function(w){i("./onto"),w.exports=function(e,o){if(!!this.on){var u=(this.opt||{}).lack||9e3;if(typeof e!="function"){if(!e)return;var h=e["#"]||e,n=(this.tag||"")[h];return n?(o&&(n=this.on(h,o),clearTimeout(n.err),n.err=setTimeout(function(){n.off()},u)),!0):void 0}var h=o&&o["#"]||t(9);if(!e)return h;var l=this.on(h,e,o);return l.err=l.err||setTimeout(function(){l.off(),l.next({err:"Error: No ACK yet.",lack:!0})},u),h}};var t=String.random||function(){return Math.random().toString(36).slice(2)}})(i,"./ask"),i(function(w){function t(p){return p instanceof t?(this._={$:this}).$:this instanceof t?t.create(this._={$:this,opt:p}):new t(p)}t.is=function(p){return p instanceof t||p&&p._&&p===p._.$||!1},t.version=.202,t.chain=t.prototype,t.chain.toJSON=function(){},i("./shim"),t.valid=i("./valid"),t.state=i("./state"),t.on=i("./onto"),t.dup=i("./dup"),t.ask=i("./ask"),function(){t.create=function(k){k.root=k.root||k,k.graph=k.graph||{},k.on=k.on||t.on,k.ask=k.ask||t.ask,k.dup=k.dup||t.dup();var G=k.$.opt(k.opt);return k.once||(k.on("in",p,k),k.on("out",p,k),k.on("put",A,k),t.on("create",k),k.on("create",k)),k.once=1,G};function p(k){if(!!k){if(k.out===p){this.to.next(k);return}var G=this,y=G.as,b=y.at||y,x=b.$,E=b.dup,B,D=k.DBG;if((B=k["#"])||(B=k["#"]=e(9)),!E.check(B)){if(E.track(B),B=k._,k._=typeof B=="function"?B:function(){},k.$&&k.$===(k.$._||"").$||(k.$=x),k["@"]&&!k.put&&a(k),!b.ask(k["@"],k))if(D&&(D.u=+new Date),k.put){f(k);return}else k.get&&t.on.get(k,x);D&&(D.uc=+new Date),G.to.next(k),D&&(D.ua=+new Date),!(k.nts||k.NTS)&&(k.out=p,b.on("out",k),D&&(D.ue=+new Date))}}}function f(k){if(!!k){var G=k._||"",y=G.root=((G.$=k.$||"")._||"").root;if(k["@"]&&G.faith&&!G.miss){k.out=p,y.on("out",k);return}G.latch=y.hatch,G.match=y.hatch=[];var b=k.put,x=G.DBG=k.DBG,E=+new Date;if(!(b["#"]&&b["."])){x&&(x.p=E),G["#"]=k["#"],G.msg=k,G.all=0,G.stun=1;var B=Object.keys(b);console.STAT&&console.STAT(E,((x||G).pk=+new Date)-E,"put sort");var D=0,N,C,I,U,P,J,K;(function M(z){if(N!=D){if(N=D,!(I=B[D])){console.STAT&&console.STAT(E,((x||G).pd=+new Date)-E,"put"),c(G);return}(U=b[I])?(K=U._)?I!==K["#"]?J=_+S(I)+"soul not same.":(P=K[">"])||(J=_+S(I)+"no state."):J=_+S(I)+"no meta.":J=_+S(I)+"no node.",C=Object.keys(U||{})}if(J){k.err=G.err=J,c(G);return}var ct=0,H;for(z=z||0;z++<9&&(H=C[ct++]);)if(H!=="_"){var V=U[H],lt=P[H];if(l===lt){J=_+S(H)+"on"+S(I)+"no state.";break}if(!u(V)){J=_+S(H)+"on"+S(I)+"bad "+typeof V+S(V);break}m(V,H,I,lt,k)}if((C=C.slice(ct)).length){o(M);return}++D,C=null,M(z)})()}}}t.on.put=f;function m(k,G,y,b,x){var E=x._||"",B=E.root,D=B.graph,N,C=D[y]||v,I=n(C,G,1),U=C[G],P=E.DBG;(N=console.STAT)&&(!D[y]||!U)&&(N.has=(N.has||0)+1);var J=O();if(b>J){setTimeout(function(){m(k,G,y,b,x)},(N=b-J)>j?j:N),console.STAT&&console.STAT((P||E).Hf=+new Date,N,"future");return}if(!(b<I&&!E.miss)&&!(!E.faith&&b===I&&(k===U||T(k)<=T(U))&&!E.miss)){E.stun++;var K=x["#"]+E.all++,M={toString:function(){return K},_:E};M.toJSON=M.toString,P&&(P.ph=P.ph||+new Date),B.on("put",{"#":M,"@":x["@"],put:{"#":y,".":G,":":k,">":b},_:E})}}function A(k){var G;(G=(k._||"").DBG)&&(G.pa=+new Date,G.pm=G.pm||+new Date);var y=this,b=y.as,x=b.graph,E=k._,B=k.put,D=B["#"],N=B["."],C=B[":"],I=B[">"];k["#"];var U;(U=E.msg)&&(U=U.put)&&(U=U[D])&&h(U,N,I,C,D),x[D]=h(x[D],N,I,C,D),(U=(b.next||"")[D])&&U.on("in",k),c(E),y.to.next(k)}function c(k,G){var y;if(!k.stop&&!(!k.err&&0<--k.stun)&&(k.stop=1,!!(y=k.root))){var b=k.match;b.end=1,b===y.hatch&&(!(b=k.latch)||b.end?delete y.hatch:y.hatch=b),k.hatch&&k.hatch(),setTimeout.each(k.match,function(x){x&&x()}),!(!(G=k.msg)||k.err||G.err)&&(G.out=p,k.root.on("out",G))}}function a(k){var G=k["@"]||"",y;!(y=G._)||(y.acks=(y.acks||0)+1,(y.err=k.err)&&(k["@"]=y["#"],c(y)),!y.stop&&!y.crack&&(y.crack=y.match&&y.match.push(function(){s(y)})),s(y))}function s(k){!k||!k.root||k.stun||k.acks!==k.all||k.root.on("in",{"@":k["#"],err:k.err,ok:k.err?l:{"":1}})}var _="Error: Invalid graph!",S=function(k){return" '"+(""+k).slice(0,9)+"...' "},T=JSON.stringify,j=2147483647,O=t.state}(),function(){t.on.get=function(f,m){var A=m._,c=f.get,a=c["#"],s=A.graph[a],_=c["."],S=A.next||(A.next={});S[a];var T=f._||{},j=T.DBG=f.DBG;if(j&&(j.g=+new Date),!s)return A.on("get",f);if(_){if(typeof _!="string"||l===s[_])return A.on("get",f);s=h({},_,n(s,_),s[_],a)}s&&p(f,s),A.on("get",f)};function p(f,m){var A=+new Date,c=f._||{},a=c.DBG=f.DBG,s=f["#"],_=e(9),S=Object.keys(m||"").sort(),T=((m||"")._||"")["#"];S.length;var j=f.$._.root,O=m===j.graph[T];console.STAT&&console.STAT(A,((a||c).gk=+new Date)-A,"got keys"),m&&function k(){A=+new Date;for(var G=0,y,b={},x;G<9&&(y=S[G++]);)h(b,y,n(m,y),m[y],T);S=S.slice(G),(x={})[T]=b,b=x;var E;O&&(E=function(){},E.ram=E.faith=!0),x=S.length,console.STAT&&console.STAT(A,-(A-(A=+new Date)),"got copied some"),a&&(a.ga=+new Date),j.on("in",{"@":s,"#":_,put:b,"%":x?_=e(9):l,$:j.$,_:E,DBG:a}),console.STAT&&console.STAT(A,+new Date-A,"got in"),!!x&&setTimeout.turn(k)}(),m||j.on("in",{"@":f["#"]})}t.on.get.ack=p}(),function(){t.chain.opt=function(p){p=p||{};var f=this,m=f._,A=p.peers||p;return Object.plain(p)||(p={}),Object.plain(m.opt)||(m.opt=p),typeof A=="string"&&(A=[A]),A instanceof Array&&(Object.plain(m.opt.peers)||(m.opt.peers={}),A.forEach(function(c){var a={};a.id=a.url=c,m.opt.peers[c]=m.opt.peers[c]||a})),m.opt.peers=m.opt.peers||{},r(p,function c(a){var s=this[a];if(this&&this.hasOwnProperty(a)||typeof s=="string"||Object.empty(s)){this[a]=s;return}s&&s.constructor!==Object&&!(s instanceof Array)||r(s,c)}),t.on("opt",m),m.opt.uuid=m.opt.uuid||function(a){return t.state().toString(36).replace(".","")+String.random(a||12)},f}}();var r=function(p,f){Object.keys(p).forEach(f,p)},e=String.random,o=setTimeout.turn,u=t.valid,n=t.state.is,h=t.state.ify,l,v={},d;t.log=function(){return!t.log.off&&d.log.apply(d,arguments),[].slice.call(arguments).join(" ")},t.log.once=function(p,f,m){return(m=t.log.once)[p]=m[p]||0,m[p]++||t.log(f)},typeof window!="undefined"&&((window.GUN=window.Gun=t).window=window);try{typeof $!="undefined"&&($.exports=t)}catch{}w.exports=t,(t.window||{}).console=(t.window||{}).console||{log:function(){}},(d=console).only=function(p,f){return d.only.i&&p===d.only.i&&d.only.i++&&(d.log.apply(d,arguments)||f)},t.log.once("welcome","Hello wonderful person! :) Thanks for using GUN, please ask for help on http://chat.gun.eco if anything takes you longer than 5min to figure out!")})(i,"./root"),i(function(w){var t=i("./root");t.chain.back=function(o,u){var n;if(o=o||1,o===-1||o===1/0)return this._.root.$;if(o===1)return(this._.back||this._).$;var h=this,l=h._;if(typeof o=="string"&&(o=o.split(".")),o instanceof Array){var v=0,d=o.length,n=l;for(v;v<d;v++)n=(n||r)[o[v]];return e!==n?u?h:n:(n=l.back)?n.$.back(o,u):void 0}if(typeof o=="function"){for(var p,n={back:l};(n=n.back)&&e===(p=o(n,u)););return p}return typeof o=="number"?(l.back||l).$.back(o-1):this};var r={},e})(i,"./back"),i(function(w){var t=i("./root");t.chain.chain=function(c){var a=this,s=a._,_=new(c||a).constructor(a),S=_._,T;return S.root=T=s.root,S.id=++T.once,S.back=a._,S.on=t.on,S.on("in",t.on.in,S),S.on("out",t.on.out,S),_};function r(c){var a,s=this.as,_=s.back,S=s.root,T;if(c.$||(c.$=s.$),this.to.next(c),s.err){s.on("in",{put:s.put=l,$:s.$});return}if(a=c.get){if(S.pass&&(S.pass[s.id]=s),s.lex&&Object.keys(s.lex).forEach(function(j){T[j]=s.lex[j]},T=c.get=c.get||{}),a["#"]||s.soul){if(a["#"]=a["#"]||s.soul,c["#"]||(c["#"]=v(9)),_=S.$.get(a["#"])._,a=a["."]){if(p(_.put,a)&&(T=_.ask&&_.ask[a],(_.ask||(_.ask={}))[a]=_.$.get(a)._,_.on("in",{get:a,put:{"#":_.soul,".":a,":":_.put[a],">":m(S.graph[_.soul],a)}}),T))return}else{if(T=_.ask&&_.ask[""],(_.ask||(_.ask={}))[""]=_,l!==_.put&&(_.on("in",_),T))return;c.$=_.$}return S.ask(n,c),S.on("in",c)}if(a["."])return s.get?(c={get:{".":s.get},$:s.$},(_.ask||(_.ask={}))[s.get]=c.$._,_.on("out",c)):(c={get:s.lex?c.get:{},$:s.$},_.on("out",c));if((s.ask||(s.ask={}))[""]=s,s.get)return a["."]=s.get,(_.ask||(_.ask={}))[s.get]=c.$._,_.on("out",c)}return _.on("out",c)}t.on.out=r;function e(c,a){a=a||this.as;var s=a.root,_=c.$||(c.$=a.$),S=(_||"")._||h,T=c.put||"",j=T["#"],O=T["."],k=l!==T["="]?T["="]:T[":"],G=T[">"]||-1/0,y;if(l!==c.put&&(l===T["#"]||l===T["."]||l===T[":"]&&l===T["="]||l===T[">"])){if(!d(T)){if(!(j=((T||"")._||"")["#"])){console.log("chain not yet supported for",T,"...",c,a);return}return _=a.root.$.get(j),setTimeout.each(Object.keys(T).sort(),function(b){b=="_"||l===(G=m(T,b))||a.on("in",{$:_,put:{"#":j,".":b,"=":T[b],">":G},VIA:c})})}a.on("in",{$:S.back.$,put:{"#":j=S.back.soul,".":O=S.has||S.get,"=":T,">":m(S.back.put,O)},via:c});return}(c.seen||"")[a.id]||((c.seen||(c.seen=function(){}))[a.id]=a,a!==S&&(Object.keys(c).forEach(function(b){T[b]=c[b]},T={}),T.get=a.get||T.get,!a.soul&&!a.has?T.$$$=T.$$$||a.$:S.soul&&(T.$=a.$,T.$$=T.$$||S.$),c=T),u(c,a),(a.soul||c.$$)&&G>=m(s.graph[j],O)&&((T=s.$.get(j)._).put=A(T.put,O,G,k,j)),!S.soul&&G>=m(s.graph[j],O)&&(y=(s.$.get(j)._.next||"")[O])&&(y.put=k,typeof(T=d(k))=="string"&&(y.put=s.$.get(T)._.put||k)),this.to&&this.to.next(c),a.any&&setTimeout.each(Object.keys(a.any),function(b){(b=a.any[b])&&b(c)},0,99),a.echo&&setTimeout.each(Object.keys(a.echo),function(b){(b=a.echo[b])&&b.on("in",c)},0,99),((c.$$||"")._||S).soul&&(y=a.next)&&(y=y[O])&&(T={},Object.keys(c).forEach(function(b){T[b]=c[b]}),T.$=(c.$$||c.$).get(T.get=O),delete T.$$,delete T.$$$,y.on("in",T)),o(c,a))}t.on.in=e;function o(c,a){if(a=a||this.as||c.$._,!(c.$$&&this!==t.on)&&!(!c.put||a.soul)){var s=c.put||"",_=s["="]||s[":"],S,T=a.root,j=T.$.get(s["#"]).get(s["."])._;if(typeof(_=d(_))!="string"){this===t.on&&((j.echo||(j.echo={}))[a.id]=a);return}if(!((j.echo||(j.echo={}))[a.id]&&!(T.pass||"")[a.id])){if(S=T.pass){if(S[_+a.id])return;S[_+a.id]=1}(j.echo||(j.echo={}))[a.id]=a,a.has&&(a.link=_);var O=T.$.get(j.link=_)._;(O.echo||(O.echo={}))[j.id]=j;var S=a.ask||"";(S[""]||a.lex)&&O.on("out",{get:{"#":_}}),setTimeout.each(Object.keys(S),function(k,G){!k||!(G=S[k])||G.on("out",{get:{"#":_,".":k}})},0,99)}}}t.on.link=o;function u(c,a){var s=c.put||"",_=l!==s["="]?s["="]:s[":"],S=a.root,T,j;if(l===_){if(a.soul&&l!==a.put||(j=(c.$$||c.$||"")._||"",c["@"]&&(l!==j.put||l!==a.put)))return;(T=a.link||c.linked)&&delete(S.$.get(T)._.echo||"")[a.id],a.has&&(a.link=null),a.put=l,setTimeout.each(Object.keys(a.next||""),function(O,k){!(k=a.next[O])||(T&&delete(S.$.get(T).get(O)._.echo||"")[k.id],k.on("in",{get:O,put:l,$:k.$}))},0,99);return}a.soul||c.$$||(T=d(_),j=c.$._||"",!((T===j.link||a.has&&!j.link)&&!((S.pass||"")[a.id]&&typeof T!="string"))&&(delete(j.echo||"")[a.id],u({get:a.get,put:l,$:c.$,linked:c.linked=c.linked||j.link},a)))}t.on.unlink=u;function n(c,a){var s=this.as,_=s.$._;_.root;var S=s.get||"",T=(c.put||"")[S["#"]]||"";if(!c.put||typeof S["."]=="string"&&l===T[S["."]]){if(l!==_.put||!_.soul&&!_.has)return;_.ack=(_.ack||0)+1,_.on("in",{get:_.get,put:_.put=l,$:_.$,"@":c["@"]});return}(c._||{}).miss=1,t.on.put(c)}var h={},l,v=String.random,d=t.valid,p=function(c,a){return c&&Object.prototype.hasOwnProperty.call(c,a)},f=t.state,m=f.is,A=f.ify})(i,"./chain"),i(function(w){var t=i("./root");t.chain.get=function(l,v,d){var p,f;if(typeof l=="string"){if(l.length==0)return(p=this.chain())._.err={err:t.log("0 length key!",l)},v&&v.call(p,p._.err),p;var m=this,A=m._,c=A.next||u;(p=c[l])||(p=l&&r(l,m)),p=p&&p.$}else if(typeof l=="function"){let j=function(O,k,G){if(!j.stun&&!((D=s.pass)&&!D[_])){var y=O.$._,b=(O.$$||"")._,x=(b||y).put,E=!y.has&&!y.soul,B={},D;if((E||h===x)&&(x=h===((D=O.put)||"")["="]?h===(D||"")[":"]?D:D[":"]:D["="]),typeof(D=t.valid(x))=="string"&&(x=h===(D=s.$.get(D)._.put)?a.not?h:x:D),!(a.not&&h===x)){if(h===a.stun){if((D=s.stun)&&D.on&&(A.$.back(function(N){if(D.on(""+N.id,B={}),(B.run||0)<j.id)return B}),!B.run&&D.on(""+y.id,B={}),!B.run&&b&&D.on(""+b.id,B={}),j.id>B.run&&((!B.stun||B.stun.end)&&(B.stun=D.on("stun"),B.stun=B.stun&&B.stun.last),B.stun&&!B.stun.end))){(B.stun.add||(B.stun.add={}))[_]=function(){j(O,k,1)};return}if(h===x&&(G=0),(D=s.hatch)&&!D.end&&h===a.hatch&&!G){if(S[y.$._.id])return;S[y.$._.id]=1,D.push(function(){j(O,k,1)});return}S={}}if(s.pass){if(s.pass[_+y.id])return;s.pass[_+y.id]=1}if(a.on){a.ok.call(y.$,x,y.get,O,k||j);return}if(a.v2020){a.ok(O,k||j);return}Object.keys(O).forEach(function(N){D[N]=O[N]},D={}),O=D,O.put=x,a.ok.call(a.as,O,k||j)}}};if(v===!0)return e(this,l,v,d),this;p=this;var A=p._,a=v||{},s=A.root,_;a.at=A,a.ok=l;var S={};return j.at=A,(A.any||(A.any={}))[_=String.random(7)]=j,j.off=function(){j.stun=1,!!A.any&&delete A.any[_]},j.rid=o,j.id=a.run||++s.once,f=s.pass,(s.pass={})[_]=1,a.out=a.out||{get:{}},A.on("out",a.out),s.pass=f,p}else{if(typeof l=="number")return this.get(""+l,v,d);if(typeof(f=n(l))=="string")return this.get(f,v,d);(f=this.get.next)&&(p=f(this,l))}return p?(v&&typeof v=="function"&&p.get(v,d),p):((p=this.chain())._.err={err:t.log("Invalid get request!",l)},v&&v.call(p,p._.err),p)};function r(l,v){var d=v._,p=d.next,f=v.chain(),m=f._;return p||(p=d.next={}),p[m.get=l]=m,v===d.root.$?m.soul=l:(d.soul||d.has)&&(m.has=l),m}function e(l,v,d,p){var f=l._,m=0,A;return(A=f.soul||f.link)?v(A,p,f):f.jam?f.jam.push([v,p]):(f.jam=[[v,p]],l.get(function(a,s){if(!(h===a.put&&!f.root.opt.super&&(A=Object.keys(f.root.opt.peers).length)&&++m<=A)){s.rid(a);var _=(_=a.$)&&_._||{},S=0,T;for(A=f.jam,delete f.jam;T=A[S++];){var j=T[0];T=T[1],j&&j(_.link||_.soul||t.valid(a.put)||((a.put||{})._||{})["#"],T,a,s)}}},{out:{get:{".":!0}}}),l)}function o(l){var v=this.at||this.on;if(!l||v.soul||v.has)return this.off();if(!!(l=(l=(l=l.$||l)._||l).id)){v.map;var d;if((d=this.seen||(this.seen={}))[l])return!0;d[l]=!0}}var u={},n=t.valid,h})(i,"./get"),i(function(w){var t=i("./root");t.chain.put=function(d,p,f){var m=this,A=m._,c=A.root;f=f||{},f.root=A.root,f.run||(f.run=c.once),r(f,A.id),f.ack=f.ack||p,f.via=f.via||m,f.data=f.data||d,f.soul||(f.soul=A.soul||typeof p=="string"&&p);var a=f.state=f.state||t.state();return typeof d=="function"?(d(function(s){f.data=s,m.put(u,u,f)}),m):f.soul?(f.$=c.$.get(f.soul),f.todo=[{it:f.data,ref:f.$}],f.turn=f.turn||h,f.ran=f.ran||e,function s(){var _=f.todo,S=_.pop(),T=S.it;S.ref&&S.ref._.id;var j,O,k,G,y;if(r(f,S.ref),(G=S.todo)&&(O=G.pop(),T=T[O],G.length&&_.push(S)),O&&(_.path||(_.path=[])).push(O),!(j=l(T))&&!(y=t.is(T))){if(!Object.plain(T)){(f.ack||n).call(f,f.out={err:f.err=t.log("Invalid data: "+(T&&(G=T.constructor)&&G.name||typeof T)+" at "+(f.via.back(function(B){B.get&&G.push(B.get)},G=[])||G.join("."))+"."+(_.path||[]).join("."))}),f.ran(f);return}for(var b=f.seen||(f.seen=[]),x=b.length;x--;)if(T===(G=b[x]).it){j=T=G.link;break}}if(O&&j)S.node=v(S.node,O,a,T);else{let B=function(D,N){var C=k.link["#"];N&&(N.off(),N.rid(D));var I=C||D.soul||(G=(D.$$||D.$)._||"").soul||G.link||((G=G.put||"")._||"")["#"]||G["#"]||((G=D.put||"")&&D.$$?G["#"]:(G["="]||G[":"]||"")["#"]);if(!C&&r(f,D.$),!I&&!S.link["#"]){(S.wait||(S.wait=[])).push(function(){B(D,N)});return}I||(I=[],(D.$$||D.$).back(function(U){if(G=U.soul||U.link)return I.push(G);I.push(U.get)}),I=I.reverse().join("/")),k.link["#"]=I,!y&&(((f.graph||(f.graph={}))[I]=k.node||(k.node={_:{}}))._["#"]=I),delete f.wait[E],k.wait&&setTimeout.each(k.wait,function(U){U&&U()}),f.ran(f)};f.seen.push(k={it:T,link:{},todo:y?[]:Object.keys(T).sort().reverse(),path:(_.path||[]).slice(),up:S}),S.node=v(S.node,O,a,k.link),!y&&k.todo.length&&_.push(k);var E=f.seen.length;(f.wait||(f.wait={}))[E]="",G=(k.ref=y?T:O?S.ref.get(O):S.ref)._,(G=T&&(T._||"")["#"]||G.soul||G.link)?B({soul:G}):k.ref.get(B,{run:f.run,v2020:1,out:{get:{".":" "}}})}if(!_.length)return f.ran(f);f.turn(s)}(),m):(o(f),m)};function r(d,p){if(!!p){p=(p._||"").id||p;var f=d.root.stun||(d.root.stun={on:t.on}),m={},A;d.stun||(d.stun=f.on("stun",function(){})),(A=f.on(""+p))&&A.the.last.next(m),!(m.run>=d.run)&&f.on(""+p,function(c){if(d.stun.end){this.off(),this.to.next(c);return}c.run=c.run||d.run,c.stun=c.stun||d.stun})}}function e(d){if(d.err){e.end(d.stun,d.root);return}if(!(d.todo.length||d.end||!Object.empty(d.wait))){d.end=1;var p=d.$.back(-1)._,f=p.root,m=p.ask(function(s){f.on("ack",s),s.err&&t.log(s),++A>(d.acks||0)&&this.off(),!!d.ack&&d.ack(s,this)},d.opt),A=0,c=d.stun,a;(a=function(){!c||(e.end(c,f),setTimeout.each(Object.keys(c=c.add||""),function(s){(s=c[s])&&s()}))}).hatch=a,d.via._.on("out",{put:d.out=d.graph,opt:d.opt,"#":m,_:a})}}e.end=function(d,p){d.end=n,d.the.to===d&&d===d.the.last&&delete p.stun,d.off()};function o(d){var p=d.via._,f;d.via=d.via.back(function(m){if(m.soul||!m.get)return m.$;f=d.data,(d.data={})[m.get]=f}),(!d.via||!d.via._.soul)&&(d.via=p.root.$.get(((d.data||"")._||"")["#"]||p.$.back("opt.uuid")())),d.via.put(d.data,d.ack,d)}var u,n=function(){},h=setTimeout.turn,l=t.valid,v=t.state.ify})(i,"./put"),i(function(w){var t=i("./root");i("./chain"),i("./back"),i("./put"),i("./get"),w.exports=t})(i,"./index"),i(function(w){var t=i("./index");t.chain.on=function(o,u,n,h){var l=this,v=l._;v.root;var d;if(typeof o=="string")return u?(d=v.on(o,u,n||v,h),n&&n.$&&(n.subs||(n.subs=[])).push(d),l):v.on(o);var p=u;return(p=p===!0?{change:!0}:p||{}).not=1,p.on=1,l.get(o,p),l},t.chain.once=function(o,u){if(u=u||{},!o)return r(this);var n=this,h=n._,l=h.root;h.put;var v=String.random(7),d;return n.get(function(p,f,m,A){var c=this,a=c._,s=a.one||(a.one={});if(A.stun||s[v]==="")return;if((d=t.valid(p))===!0){_();return}if(typeof d=="string")return;clearTimeout((h.one||"")[v]),clearTimeout(s[v]),s[v]=setTimeout(_,u.wait||99);function _(){!a.has&&!a.soul&&(a={put:p,get:f}),e===(d=a.put)&&(d=((m.$$||"")._||"").put),!(typeof t.valid(d)=="string"&&(d=l.$.get(d)._.put,d===e))&&(A.stun||s[v]!==""&&(s[v]="",(h.soul||h.has)&&A.off(),o.call(c,d,a.get)))}},{on:1}),n};function r(o,u,n){return t.log.once("valonce","Chainable val is experimental, its behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),(n=o.chain())._.nix=o.once(function(h,l){n._.on("in",this._)}),n._.lex=o._.lex,n}t.chain.off=function(){var o=this,u=o._,n,h=u.back;if(!!h)return u.ack=0,(n=h.next)&&n[u.get]&&delete n[u.get],(n=h.ask)&&delete n[u.get],(n=h.put)&&delete n[u.get],(n=u.soul)&&delete h.root.graph[n],(n=u.map)&&Object.keys(n).forEach(function(l,v){v=n[l],v.link&&h.root.$.get(v.link).off()}),(n=u.next)&&Object.keys(n).forEach(function(l,v){v=n[l],v.$.off()}),u.on("off",{}),o};var e})(i,"./on"),i(function(w){var t=i("./index"),r=t.chain.get.next;t.chain.get.next=function(n,h){var l;return Object.plain(h)?(l=((l=h["#"])||"")["="]||l)?n.get(l):((l=n.chain()._).lex=h,n.on("in",function(v){String.match(v.get||(v.put||"")["."],h["."]||h["#"]||h)&&l.on("in",v),this.to.next(v)}),l.$):(r||o)(n,h)},t.chain.map=function(n,h,l){var v=this,d=v._,p,f;return Object.plain(n)&&(p=n["."]?n:{".":n},n=u),n?(t.log.once("mapfn","Map functions are experimental, their behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),f=v.chain(),v.map().on(function(m,A,c,a){var s=(n||o).call(this,m,A,c,a);if(u!==s){if(m===s)return f._.on("in",c);if(t.is(s))return f._.on("in",s._);var _={};Object.keys(c.put).forEach(function(S){_[S]=c.put[S]},_),_["="]=s,f._.on("in",{get:A,put:_})}}),f):((f=d.each)||((d.each=f=v.chain())._.lex=p||f._.lex||d.lex,f._.nix=v.back("nix"),v.on("in",e,f._)),f)};function e(n){this.to.next(n);var h=this.as,l=n.$,v=l._,d=n.put,p;!v.soul&&!n.$$||(p=h.lex)&&!String.match(n.get||(d||"")["."],p["."]||p["#"]||p)||t.on.link(n,h)}var o=function(){},u})(i,"./map"),i(function(w){var t=i("./index");t.chain.set=function(r,e,o){var u=this,n=u.back(-1),h,l;return e=e||function(){},o=o||{},o.item=o.item||r,(h=((r||"")._||"")["#"])&&((r={})["#"]=h),typeof(l=t.valid(r))=="string"?u.get(h=l).put(r,e,o):t.is(r)?(u.put(function(v){r.get(function(d,p,f){if(!d)return e.call(u,{err:t.log('Only a node can be linked! Not "'+f.put+'"!')});(l={})[d]={"#":d},v(l)},!0)}),r):(Object.plain(r)&&(r=n.get(h=u.back("opt.uuid")()).put(r)),u.get(h||n.back("opt.uuid")(7)).put(r,e,o))}})(i,"./set"),i(function(w){i("./shim");function t(e){var o=function(){},u=e.opt||{};u.log=u.log||console.log,u.gap=u.gap||u.wait||0,u.max=u.max||(u.memory?u.memory*999*999:3e8)*.3,u.pack=u.pack||u.max*.01*.01,u.puff=u.puff||9;var n=setTimeout.turn||setTimeout,h=JSON.parseAsync||function(a,s,_){var S;try{s(S,JSON.parse(a,_))}catch(T){s(T)}},l=JSON.stringifyAsync||function(a,s,_,S){var T;try{s(T,JSON.stringify(a,_,S))}catch(j){s(j)}},v=e.dup,d=v.check,p=v.track,f=o.hear=function(a,s){if(!!a){if(u.max<=a.length)return o.say({dam:"!",err:"Message too big!"},s);o===this&&(f.d+=a.length||0,++f.c);var _=s.SH=+new Date,S=a[0],T;if(S==="["){h(a,function(j,O){if(j||!O)return o.say({dam:"!",err:"DAM JSON parse error."},s);console.STAT&&console.STAT(+new Date,O.length,"# on hear batch");var k=u.puff;(function G(){for(var y=+new Date,b=0,x;b<k&&(x=O[b++]);)f(x,s);O=O.slice(b),console.STAT&&console.STAT(y,+new Date-y,"hear loop"),m(s),!!O.length&&n(G,0)})()}),a="";return}if(S==="{"||(a["#"]||Object.plain(a))&&(T=a)){if(T)return f.one(T,s,_);h(a,function(j,O){if(j||!O)return o.say({dam:"!",err:"DAM JSON parse error."},s);f.one(O,s,_)});return}}};f.one=function(a,s,_){var S,T,j,O,k;if(a.DBG&&(a.DBG=k={DBG:a.DBG}),k&&(k.h=_),k&&(k.hp=+new Date),(S=a["#"])||(S=a["#"]=String.random(9)),!(j=d(S))&&(T=a["##"],!(T&&(j=a["@"]||a.get&&S)&&v.check(O=j+T)))){if((a._=function(){}).via=o.leap=s,(j=a["><"])&&typeof j=="string"&&j.slice(0,99).split(",").forEach(function(G){this[G]=1},a._.yo={}),j=a.dam){(j=o.hear[j])&&j(a,s,e),p(S);return}var _=+new Date;k&&(k.is=_),s.SI=S,e.on("in",o.last=a),k&&(k.hd=+new Date),console.STAT&&console.STAT(_,+new Date-_,a.get?"msg get":a.put?"msg put":"msg"),(j=p(S)).via=s,a.get&&(j.it=a),O&&p(O),o.leap=o.last=null}},f.c=f.d=0,function(){var a=0,s;o.hash=function(j,O){var k,G,y,b=+new Date;l(j.put,function x(E,B){var D=(G||(G=y=B||"")).slice(0,32768);if(k=String.hash(D,k),G=G.slice(32768),G){n(x,0);return}console.STAT&&console.STAT(b,+new Date-b,"say json+hash"),j._.$put=y,j["##"]=k,T(j,O),delete j._.$put},_)};function _(j,O){var k;return O instanceof Object?(Object.keys(O).sort().forEach(S,{to:k={},on:O}),k):O}function S(j){this.to[j]=this.on[j]}var T=o.say=function(j,O){var k;if((k=this)&&(k=k.to)&&k.next&&k.next(j),!j)return!1;var G,y,b=j["@"],x=j._||(j._=function(){}),E=j.DBG,B=+new Date;if(x.y=x.y||B,O||E&&(E.y=B),(G=j["#"])||(G=j["#"]=String.random(9)),!s&&p(G),j.put&&(j.err||(v.s[G]||"").err))return!1;if(!j["##"]&&r!==j.put&&!x.via&&b){o.hash(j,O);return}if(!O&&b&&(O=(k=v.s[b])&&(k.via||(k=k.it)&&(k=k._)&&k.via)||(k=o.last)&&b===k["#"]&&o.leap),!O&&b)return v.s[b]?void 0:(console.STAT&&console.STAT(+new Date,++a,"total no peer to ack to"),!1);if(!O&&o.way)return o.way(j);if(E&&(E.yh=+new Date),!(y=x.raw)){o.raw(j,O);return}if(E&&(E.yr=+new Date),!O||!O.id){if(!Object.plain(O||u.peers))return!1;var B=+new Date;u.puff;var D=u.peers,N=Object.keys(O||u.peers||{});console.STAT&&console.STAT(B,+new Date-B,"peer keys"),function U(){var P=+new Date;s=1;var J=x.raw;x.raw=y;for(var K=0,M;K<9&&(M=(N||"")[K++]);)!(M=D[M])||T(j,M);x.raw=J,s=0,N=N.slice(K),console.STAT&&console.STAT(P,+new Date-P,"say loop"),!!N.length&&(n(U,0),b&&p(b))}();return}if(!O.wire&&o.wire&&o.wire(O),G!==O.last){if(O.last=G,O===x.via||(k=x.yo)&&(k[O.url]||k[O.pid]||k[O.id]))return!1;if(console.STAT&&console.STAT(B,((E||x).yp=+new Date)-(x.y||B),"say prep"),!s&&b&&p(b),O.batch){if(O.tail=(k=O.tail||0)+y.length,O.tail<=u.pack){O.batch+=(k?",":"")+y;return}m(O)}O.batch="[";var C=+new Date;setTimeout(function(){console.STAT&&console.STAT(C,+new Date-C,"0ms TO"),m(O)},u.gap),A(y,O),console.STAT&&b===O.SI&&console.STAT(B,+new Date-O.SH,"say ack")}};o.say.c=o.say.d=0,o.raw=function(j,O){if(!j)return"";var k=j._||{},G,y;if(y=k.raw)return y;if(typeof j=="string")return j;var b=j["##"],x=j["@"];if(b&&x){if(!k.via&&d(x+b))return!1;if((y=(v.s[x]||"").it)||(y=o.last)&&x===y["#"]){if(b===y["##"])return!1;y["##"]||(y["##"]=b)}}if(!j.dam){var E=0,B=[];y=u.peers;for(var D in y){var N=y[D];if(B.push(N.url||N.pid||N.id),++E>6)break}E>1&&(j["><"]=B.join())}if(G=k.$put){y={},Object.keys(j).forEach(function(I){y[I]=j[I]}),y.put=":])([:",l(y,function(I,U){if(!I){var P=+new Date;y=U.indexOf('"put":":])([:"'),C(r,U=U.slice(0,y+6)+G+U.slice(y+14)),console.STAT&&console.STAT(P,+new Date-P,"say slice")}});return}l(j,C);function C(I,U){I||(k.raw=U,T(j,O))}}}();function m(a){var s=a.batch,_=typeof s=="string";if(_&&(s+="]"),a.batch=a.tail=null,!!s&&!(_?3>s.length:!s.length)){if(!_)try{s=s.length===1?s[0]:JSON.stringify(s)}catch(S){return u.log("DAM JSON stringify error",S)}!s||A(s,a)}}function A(a,s){try{var _=s.wire;s.say?s.say(a):_.send&&_.send(a),o.say.d+=a.length||0,++o.say.c}catch{(s.queue=s.queue||[]).push(a)}}o.hi=function(a){var s=a.wire||{};a.id?u.peers[a.url||a.id]=a:(s=a.id=a.id||String.random(9),o.say({dam:"?",pid:e.opt.pid},u.peers[s]=a),delete v.s[a.last]),a.met=a.met||+new Date,s.hied||e.on(s.hied="hi",a),s=a.queue,a.queue=[],setTimeout.each(s||[],function(_){A(_,a)},0,9)},o.bye=function(a){e.on("bye",a);var s=+new Date;s=s-(a.met||s),o.bye.time=((o.bye.time||s)+s)/2},o.hear["!"]=function(a,s){u.log("Error:",a.err)},o.hear["?"]=function(a,s){a.pid&&(s.pid||(s.pid=a.pid),a["@"])||(o.say({dam:"?",pid:u.pid,"@":a["#"]},s),delete v.s[s.last])},e.on("create",function(a){a.opt.pid=a.opt.pid||String.random(9),this.to.next(a),a.on("out",o.say)}),e.on("bye",function(a,s){a=u.peers[a.id||a]||a,this.to.next(a),a.bye?a.bye():(s=a.wire)&&s.close&&s.close(),delete u.peers[a.id],a.wire=null});var c={};return e.on("bye",function(a,s){this.to.next(a),(s=console.STAT)&&(s.peers=(s.peers||0)-1),!!(s=a.url)&&(c[s]=!0,setTimeout(function(){delete c[s]},u.lack||9e3))}),e.on("hi",function(a,s){this.to.next(a),(s=console.STAT)&&(s.peers=(s.peers||0)+1),!(!(s=a.url)||!c[s])&&(delete c[s],!u.super&&setTimeout.each(Object.keys(e.next),function(_){e.next[_],s={},s[_]=e.graph[_],s=String.hash(s),o.say({"##":s,get:{"#":_}},a)}))}),o}var r;try{w.exports=t}catch{}})(i,"./mesh"),i(function(w){var t=i("../index");t.Mesh=i("./mesh"),t.on("opt",function(e){if(this.to.next(e),e.once)return;var o=e.opt;if(o.WebSocket===!1)return;var u=t.window||{},n=o.WebSocket||u.WebSocket||u.webkitWebSocket||u.mozWebSocket;if(!n)return;o.WebSocket=n;var h=o.mesh=o.mesh||t.Mesh(e);h.wire||o.wire,h.wire=o.wire=l;function l(f){try{if(!f||!f.url)return A&&A(f);var m=f.url.replace(/^http/,"ws"),A=f.wire=new o.WebSocket(m);return A.onclose=function(){o.mesh.bye(f),d(f)},A.onerror=function(c){d(f)},A.onopen=function(){o.mesh.hi(f)},A.onmessage=function(c){!c||o.mesh.hear(c.data||c,f)},A}catch{}}setTimeout(function(){!o.super&&e.on("out",{dam:"hi"})},1);var v=2*999;function d(f){clearTimeout(f.defer),!(p&&f.retry<=0)&&(f.retry=(f.retry||o.retry+1||60)-(-f.tried+(f.tried=+new Date)<v*4?1:0),f.defer=setTimeout(function m(){if(p&&p.hidden)return setTimeout(m,v);l(f)},v))}var p=""+r!=typeof document&&document});var r})(i,"./websocket"),i(function(w){if(typeof Gun!="undefined"){var t=function(){},r;try{r=(Gun.window||t).localStorage}catch{}r||(Gun.log("Warning: No localStorage exists to persist data to!"),r={setItem:function(e,o){this[e]=o},removeItem:function(e){delete this[e]},getItem:function(e){return this[e]}}),Gun.on("create",function e(o){this.to.next(o);var u=o.opt;o.graph;var n=[],h,l;if(u.localStorage===!1)return;u.prefix=u.file||"gun/";try{h=e[u.prefix]=e[u.prefix]||JSON.parse(r.getItem(u.prefix))||{}}catch{h=e[u.prefix]={}}o.on("get",function(d){this.to.next(d);var p=d.get,f,m,A,c;!p||!(f=p["#"])||(m=h[f]||c,m&&(A=p["."])&&!Object.plain(A)&&(m=Gun.state.ify({},A,Gun.state.is(m,A),m[A],f)),Gun.on.get.ack(d,m))}),o.on("put",function(d){this.to.next(d);var p=d.put,f=p["#"],m=p["."];h[f]=Gun.state.ify(h[f],m,p[">"],p[":"],f),d["@"]||n.push(d["#"]),!l&&(l=setTimeout(v,u.wait||1))});function v(){var d,p=n;clearTimeout(l),l=!1,n=[];try{r.setItem(u.prefix,JSON.stringify(h))}catch(f){Gun.log((d=f||"localStorage failure")+" Consider using GUN's IndexedDB plugin for RAD for more storage space, https://gun.eco/docs/RAD#install"),o.on("localStorage:error",{err:d,get:u.prefix,put:h})}!d&&!Object.empty(u.peers)||setTimeout.each(p,function(f){o.on("in",{"@":f,err:d,ok:0})})}})}})(i,"./localStorage")})(),function(){var i;if(""+i!=typeof Gun){var $=function(y){console.log("Warning! Deprecated internal utility will break in next version:",y)},w=Gun;w.fn=w.fn||{is:function(y){return $("fn"),!!y&&typeof y=="function"}},w.bi=w.bi||{is:function(y){return $("bi"),y instanceof Boolean||typeof y=="boolean"}},w.num=w.num||{is:function(y){return $("num"),!r(y)&&(y-parseFloat(y)+1>=0||y===1/0||y===-1/0)}},w.text=w.text||{is:function(y){return $("text"),typeof y=="string"}},w.text.ify=w.text.ify||function(y){return $("text.ify"),w.text.is(y)?y:typeof JSON!="undefined"?JSON.stringify(y):y&&y.toString?y.toString():y},w.text.random=w.text.random||function(y,b){$("text.random");var x="";for(y=y||24,b=b||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";y>0;)x+=b.charAt(Math.floor(Math.random()*b.length)),y--;return x},w.text.match=w.text.match||function(y,b){var x,E;return $("text.match"),typeof y!="string"?!1:(typeof b=="string"&&(b={"=":b}),b=b||{},x=b["="]||b["*"]||b[">"]||b["<"],y===x?!0:E!==b["="]?!1:(x=b["*"]||b[">"]||b["<"],y.slice(0,(x||"").length)===x?!0:E!==b["*"]?!1:E!==b[">"]&&E!==b["<"]?y>=b[">"]&&y<=b["<"]:E!==b[">"]&&y>=b[">"]||E!==b["<"]&&y<=b["<"]))},w.text.hash=w.text.hash||function(y,b){if($("text.hash"),typeof y=="string"){if(b=b||0,!y.length)return b;for(var x=0,E=y.length,B;x<E;++x)B=y.charCodeAt(x),b=(b<<5)-b+B,b|=0;return b}},w.list=w.list||{is:function(y){return $("list"),y instanceof Array}},w.list.slit=w.list.slit||Array.prototype.slice,w.list.sort=w.list.sort||function(y){return $("list.sort"),function(b,x){return!b||!x?0:(b=b[y],x=x[y],b<x?-1:b>x?1:0)}},w.list.map=w.list.map||function(y,b,x){return $("list.map"),n(y,b,x)},w.list.index=1,w.obj=w.boj||{is:function(y){return $("obj"),y?y instanceof Object&&y.constructor===Object||Object.prototype.toString.call(y).match(/^\[object (\w+)\]$/)[1]==="Object":!1}},w.obj.put=w.obj.put||function(y,b,x){return $("obj.put"),(y||{})[b]=x,y},w.obj.has=w.obj.has||function(y,b){return $("obj.has"),y&&Object.prototype.hasOwnProperty.call(y,b)},w.obj.del=w.obj.del||function(y,b){if($("obj.del"),!!y)return y[b]=null,delete y[b],y},w.obj.as=w.obj.as||function(y,b,x,E){return $("obj.as"),y[b]=y[b]||(E===x?{}:x)},w.obj.ify=w.obj.ify||function(y){if($("obj.ify"),o(y))return y;try{y=JSON.parse(y)}catch{y={}}return y},function(){var y;function b(x,E){u(this,E)&&y!==this[E]||(this[E]=x)}w.obj.to=w.obj.to||function(x,E){return $("obj.to"),E=E||{},n(x,b,E),E}}(),w.obj.copy=w.obj.copy||function(y){return $("obj.copy"),y&&JSON.parse(JSON.stringify(y))},function(){function y(b,x){var E=this.n,B;if(!(E&&(x===E||o(E)&&u(E,x)))&&B!==x)return!0}w.obj.empty=w.obj.empty||function(b,x){return $("obj.empty"),b?!n(b,y,{n:x}):!0}}(),function(){function y(E,B){if(arguments.length===2){y.r=y.r||{},y.r[E]=B;return}y.r=y.r||[],y.r.push(E)}var b=Object.keys,x;Object.keys=Object.keys||function(E){return x(E,function(B,D,N){N(D)})},w.obj.map=x=w.obj.map||function(E,B,D){$("obj.map");var N,C=0,I,U,P,J,K=typeof B=="function";if(y.r=N,b&&o(E)&&(P=b(E),J=!0),D=D||{},r(E)||P)for(I=(P||E).length;C<I;C++){var M=C+w.list.index;if(K){if(U=J?B.call(D,E[P[C]],P[C],y):B.call(D,E[C],M,y),U!==N)return U}else if(B===E[J?P[C]:C])return P?P[C]:M}else for(C in E)if(K){if(u(E,C)&&(U=D?B.call(D,E[C],C,y):B(E[C],C,y),U!==N))return U}else if(B===E[C])return C;return K?y.r:w.list.index?0:-1}}(),w.time=w.time||{},w.time.is=w.time.is||function(y){return $("time"),y?y instanceof Date:+new Date().getTime()};var t=w.fn.is,r=w.list.is,e=w.obj,o=e.is,u=e.has,n=e.map,h={};h.is=function(y){return $("val.is"),y===i?!1:y===null?!0:y===1/0?!1:p(y)||v(y)||d(y)?!0:h.link.is(y)||!1},h.link=h.rel={_:"#"},function(){h.link.is=function(b){if($("val.link.is"),b&&b[l]&&!b._&&o(b)){var x={};if(n(b,y,x),x.id)return x.id}return!1};function y(b,x){var E=this;if(E.id)return E.id=!1;if(x==l&&p(b))E.id=b;else return E.id=!1}}(),h.link.ify=function(y){return $("val.link.ify"),f({},l,y)},w.obj.has._=".";var l=h.link._,i,v=w.bi.is,d=w.num.is,p=w.text.is,e=w.obj,o=e.is,f=e.put,n=e.map;w.val=w.val||h;var m={_:"_"};m.soul=function(y,b){return $("node.soul"),y&&y._&&y._[b||s]},m.soul.ify=function(y,b){return $("node.soul.ify"),b=typeof b=="string"?{soul:b}:b||{},y=y||{},y._=y._||{},y._[s]=b.soul||y._[s]||a(),y},m.soul._=h.link._,function(){m.is=function(b,x,E){$("node.is");var B;return o(b)&&(B=m.soul(b))?!n(b,y,{as:E,cb:x,s:B,n:b}):!1};function y(b,x){if(x!==m._){if(!h.is(b))return!0;this.cb&&this.cb.call(this.as,b,x,this.n,this.s)}}}(),function(){m.ify=function(b,x,E){return $("node.ify"),x?typeof x=="string"?x={soul:x}:typeof x=="function"&&(x={map:x}):x={},x.map&&(x.node=x.map.call(E,b,i,x.node||{})),(x.node=m.soul.ify(x.node||{},x))&&n(b,y,{o:x,as:E}),x.node};function y(b,x){var E=this.o,B,D;if(E.map){B=E.map.call(this.as,b,""+x,E.node),D===B?A(E.node,x):E.node&&(E.node[x]=B);return}h.is(b)&&(E.node[x]=b)}}();var e=w.obj,o=e.is,A=e.del,n=e.map,c=w.text,a=c.random,s=m.soul._,i;w.node=w.node||m;var _=w.state;_.lex=function(){return $("state.lex"),_().toString(36).replace(".","")},_.to=function(y,b,x){$("state.to");var E=(y||{})[b];return o(E)&&(E=S(E)),_.ify(x,b,_.is(y,b),E,m.soul(y))},function(){_.map=function(b,x,E){$("state.map");var B,D=o(D=b||x)?D:null;return b=t(b=b||x)?b:null,D&&!b?(x=d(x)?x:_(),D[O]=D[O]||{},n(D,y,{o:D,s:x}),D):(E=E||o(x)?x:B,x=d(x)?x:_(),function(N,C,I,U){if(!b)return y.call({o:I,s:x},N,C),N;b.call(E||this||{},N,C,I,U),!(u(I,C)&&B===I[C])&&y.call({o:I,s:x},N,C)})};function y(b,x){O!==x&&_.ify(this.o,x,this.s)}}();var e=w.obj;e.as;var u=e.has,o=e.is,n=e.map,S=e.copy,T=w.num,d=T.is,j=w.fn,t=j.is,O=m._,i,k={};(function(){k.is=function(x,E,B,D){return $("graph.is"),!x||!o(x)||G(x)?!1:!n(x,y,{cb:E,fn:B,as:D})};function y(x,E){if(!x||E!==m.soul(x)||!m.is(x,this.fn,this.as))return!0;!this.cb||(b.n=x,b.as=this.as,this.cb.call(b.as,x,E,b))}function b(x){x&&m.is(b.n,x,b.as)}})(),function(){k.ify=function(D,N,C){$("graph.ify");var I={path:[],obj:D};return N?typeof N=="string"?N={soul:N}:typeof N=="function"&&(N.map=N):N={},typeof C=="string"&&(N.soul=N.soul||C,C=i),N.soul&&(I.link=h.link.ify(N.soul)),N.shell=(C||{}).shell,N.graph=N.graph||{},N.seen=N.seen||[],N.as=N.as||C,y(N,I),N.root=I.node,N.graph};function y(D,N){var C;return(C=B(D,N))?C:(N.env=D,N.soul=x,m.ify(N.obj,b,N)&&(N.link=N.link||h.link.ify(m.soul(N.node)),N.obj!==D.shell&&(D.graph[h.link.is(N.link)]=N.node)),N)}function b(D,N,C){var I=this,U=I.env,P,J;if(m._===N&&u(D,h.link._))return C._;if(!!(P=E(D,N,C,I,U))){if(N||(I.node=I.node||C||{},u(D,m._)&&m.soul(D)&&(I.node._=S(D._)),I.node=m.soul.ify(I.node,h.link.is(I.link)),I.link=I.link||h.link.ify(m.soul(I.node))),(J=U.map)&&(J.call(U.as||{},D,N,C,I),u(C,N))){if(D=C[N],i===D){A(C,N);return}if(!(P=E(D,N,C,I,U)))return}if(!N)return I.node;if(P===!0)return D;if(J=y(U,{obj:D,path:I.path.concat(N)}),!!J.node)return J.link}}function x(D){var N=this,C=h.link.is(N.link),I=N.env.graph;N.link=N.link||h.link.ify(D),N.link[h.link._]=D,N.node&&N.node[m._]&&(N.node[m._][h.link._]=D),u(I,C)&&(I[D]=I[C],A(I,C))}function E(D,N,C,I,U){var P;if(h.is(D))return!0;if(o(D))return 1;if(P=U.invalid)return D=P.call(U.as||{},D,N,C),E(D,N,C,I,U);U.err="Invalid value at '"+I.path.concat(N).join(".")+"'!",w.list.is(D)&&(U.err+=" Use `.set(item)` instead of an Array.")}function B(D,N){for(var C=D.seen,I=C.length,U;I--;)if(U=C[I],N.obj===U.obj)return U;C.push(N)}}(),k.node=function(y){$("graph.node");var b=m.soul(y);if(!!b)return f({},b,y)},function(){k.to=function(b,x,E){if($("graph.to"),!!b){var B={};return E=E||{seen:{}},n(b[x],y,{obj:B,graph:b,opt:E}),B}};function y(b,x){var E,B;if(m._===x){if(G(b,h.link._))return;this.obj[x]=S(b);return}if(!(E=h.link.is(b))){this.obj[x]=b;return}if(B=this.opt.seen[E]){this.obj[x]=B;return}this.obj[x]=this.opt.seen[E]=k.to(this.graph,E,this.opt)}}();var t=w.fn.is,e=w.obj,o=e.is,A=e.del,u=e.has,G=e.empty,f=e.put,n=e.map,S=e.copy,i;w.graph=w.graph||k}}()})(kt);var Te=kt.exports,Xt={exports:{}};(function(g){(function(){function i(w,t){return t?st(w):w.slice?i[r(w)]:function(e,o){w(e={exports:{}}),i[r(o)]=e.exports};function r(e){return e.split("/").slice(-1).toString().replace(".js","")}}var $=g;i(function(w){typeof window!="undefined"&&(w.window=window);var t=w.window||w,r,e=t.SEA||{};(e.window=w.window)&&(e.window.SEA=e);try{r+""!=typeof $&&($.exports=e)}catch{}w.exports=e})(i,"./root"),i(function(w){var t=i("./root");try{t.window&&location.protocol.indexOf("s")<0&&location.host.indexOf("localhost")<0&&!/^127\.\d+\.\d+\.\d+$/.test(location.hostname)&&location.protocol.indexOf("file:")<0&&(console.warn("HTTPS needed for WebCrypto in SEA, redirecting..."),location.protocol="https:")}catch{}})(i,"./https"),i(function(w){var t;if(t+""==typeof btoa){if(t+""==typeof Buffer)try{ft.Buffer=i("buffer",1).Buffer}catch{console.log("Please `npm install buffer` or add it to your package.json !")}ft.btoa=function(r){return Buffer.from(r,"binary").toString("base64")},ft.atob=function(r){return Buffer.from(r,"base64").toString("binary")}}})(i,"./base64"),i(function(w){i("./base64");function t(){}Object.assign(t,{from:Array.from}),t.prototype=Object.create(Array.prototype),t.prototype.toString=function(r,e,o){r=r||"utf8",e=e||0;const u=this.length;if(r==="hex"){const n=new Uint8Array(this);return[...Array((o&&o+1||u)-e).keys()].map(h=>n[h+e].toString(16).padStart(2,"0")).join("")}if(r==="utf8")return Array.from({length:(o||u)-e},(n,h)=>String.fromCharCode(this[h+e])).join("");if(r==="base64")return btoa(this)},w.exports=t})(i,"./array"),i(function(w){i("./base64");var t=i("./array");function r(...e){return console.warn("new SafeBuffer() is depreciated, please use SafeBuffer.from()"),r.from(...e)}r.prototype=Object.create(Array.prototype),Object.assign(r,{from(){if(!Object.keys(arguments).length||arguments[0]==null)throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");const e=arguments[0];let o;if(typeof e=="string"){const n=arguments[1]||"utf8";if(n==="hex"){const h=e.match(/([\da-fA-F]{2})/g).map(l=>parseInt(l,16));if(!h||!h.length)throw new TypeError("Invalid first argument for type 'hex'.");o=t.from(h)}else if(n==="utf8"||n==="binary"){const h=e.length,l=new Uint16Array(h);Array.from({length:h},(v,d)=>l[d]=e.charCodeAt(d)),o=t.from(l)}else if(n==="base64"){const h=atob(e),l=h.length,v=new Uint8Array(l);Array.from({length:l},(d,p)=>v[p]=h.charCodeAt(p)),o=t.from(v)}else n==="binary"?o=t.from(e):console.info("SafeBuffer.from unknown encoding: "+n);return o}if(e.byteLength,e.byteLength?e.byteLength:e.length){let n;return e instanceof ArrayBuffer&&(n=new Uint8Array(e)),t.from(n||e)}},alloc(e,o=0){return t.from(new Uint8Array(Array.from({length:e},()=>o)))},allocUnsafe(e){return t.from(new Uint8Array(Array.from({length:e})))},concat(e){if(!Array.isArray(e))throw new TypeError("First argument must be Array containing ArrayBuffer or Uint8Array instances.");return t.from(e.reduce((o,u)=>o.concat(Array.from(u)),[]))}}),r.prototype.from=r.from,r.prototype.toString=t.prototype.toString,w.exports=r})(i,"./buffer"),i(function(w){const t=i("./root"),r={Buffer:i("./buffer")};var e={},o;if(JSON.parseAsync=JSON.parseAsync||function(n,h,l){var v;try{h(v,JSON.parse(n,l))}catch(d){h(d)}},JSON.stringifyAsync=JSON.stringifyAsync||function(n,h,l,v){var d;try{h(d,JSON.stringify(n,l,v))}catch(p){h(p)}},r.parse=function(n,h){return new Promise(function(l,v){JSON.parseAsync(n,function(d,p){d?v(d):l(p)},h)})},r.stringify=function(n,h,l){return new Promise(function(v,d){JSON.stringifyAsync(n,function(p,f){p?d(p):v(f)},h,l)})},t.window&&(r.crypto=window.crypto||window.msCrypto,r.subtle=(r.crypto||e).subtle||(r.crypto||e).webkitSubtle,r.TextEncoder=window.TextEncoder,r.TextDecoder=window.TextDecoder,r.random=n=>r.Buffer.from(r.crypto.getRandomValues(new Uint8Array(r.Buffer.alloc(n))))),!r.TextDecoder){const{TextEncoder:n,TextDecoder:h}=i((o+""==typeof $?".":"")+"./lib/text-encoding",1);r.TextDecoder=h,r.TextEncoder=n}if(!r.crypto)try{var u=i("crypto",1);Object.assign(r,{crypto:u,random:h=>r.Buffer.from(u.randomBytes(h))});const{Crypto:n}=i("@peculiar/webcrypto",1);r.ossl=r.subtle=new n({directory:"ossl"}).subtle}catch{console.log("Please `npm install @peculiar/webcrypto` or add it to your package.json !")}w.exports=r})(i,"./shim"),i(function(w){var t=i("./root"),r=i("./shim"),e={};e.pbkdf2={hash:{name:"SHA-256"},iter:1e5,ks:64},e.ecdsa={pair:{name:"ECDSA",namedCurve:"P-256"},sign:{name:"ECDSA",hash:{name:"SHA-256"}}},e.ecdh={name:"ECDH",namedCurve:"P-256"},e.jwk=function(o,u){o=o.split(".");var n=o[0],h=o[1],l={kty:"EC",crv:"P-256",x:n,y:h,ext:!0};return l.key_ops=u?["sign"]:["verify"],u&&(l.d=u),l},e.keyToJwk=function(o){const n=o.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"");return{kty:"oct",k:n,ext:!1,alg:"A256GCM"}},e.recall={validity:12*60*60,hook:function(o){return o}},e.check=function(o){return typeof o=="string"&&o.slice(0,4)==="SEA{"},e.parse=async function(u){try{var n=typeof u=="string";return n&&u.slice(0,4)==="SEA{"&&(u=u.slice(3)),n?await r.parse(u):u}catch{}return u},t.opt=e,w.exports=e})(i,"./settings"),i(function(w){var t=i("./shim");w.exports=async function(r,e){var o=typeof r=="string"?r:await t.stringify(r),u=await t.subtle.digest({name:e||"SHA-256"},new t.TextEncoder().encode(o));return t.Buffer.from(u)}})(i,"./sha256"),i(function(w){const t=i("./shim"),r=t.subtle,e=t.ossl?t.ossl:r,o=u=>e.digest({name:"SHA-1"},new ArrayBuffer(u));w.exports=o})(i,"./sha1"),i(function(w){var t=i("./root"),r=i("./shim"),e=i("./settings"),o=i("./sha256"),u;t.work=t.work||(async(n,h,l,v)=>{try{var d=(h||{}).epub||h;if(v=v||{},d instanceof Function&&(l=d,d=u),n=typeof n=="string"?n:await r.stringify(n),(v.name||"").toLowerCase().slice(0,3)==="sha"){var p=r.Buffer.from(await o(n,v.name),"binary").toString(v.encode||"base64");if(l)try{l(p)}catch(c){console.log(c)}return p}d=d||r.random(9);var f=await(r.ossl||r.subtle).importKey("raw",new r.TextEncoder().encode(n),{name:v.name||"PBKDF2"},!1,["deriveBits"]),m=await(r.ossl||r.subtle).deriveBits({name:v.name||"PBKDF2",iterations:v.iterations||e.pbkdf2.iter,salt:new r.TextEncoder().encode(v.salt||d),hash:v.hash||e.pbkdf2.hash},f,v.length||e.pbkdf2.ks*8);n=r.random(n.length);var A=r.Buffer.from(m,"binary").toString(v.encode||"base64");if(l)try{l(A)}catch(c){console.log(c)}return A}catch(c){if(console.log(c),t.err=c,t.throw)throw c;l&&l();return}}),w.exports=t.work})(i,"./work"),i(function(w){var t=i("./root"),r=i("./shim");i("./settings"),t.name=t.name||(async(e,o)=>{try{if(e)try{e()}catch(u){console.log(u)}return}catch(u){if(console.log(u),t.err=u,t.throw)throw u;e&&e();return}}),t.pair=t.pair||(async(e,o)=>{try{var u=r.ossl||r.subtle,n=await r.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!0,["sign","verify"]).then(async v=>{var d={};d.priv=(await r.subtle.exportKey("jwk",v.privateKey)).d;var p=await r.subtle.exportKey("jwk",v.publicKey);return d.pub=p.x+"."+p.y,d});try{var h=await u.generateKey({name:"ECDH",namedCurve:"P-256"},!0,["deriveKey"]).then(async v=>{var d={};d.epriv=(await u.exportKey("jwk",v.privateKey)).d;var p=await u.exportKey("jwk",v.publicKey);return d.epub=p.x+"."+p.y,d})}catch(v){if(t.window)throw v;if(v=="Error: ECDH is not a supported algorithm")console.log("Ignoring ECDH...");else throw v}h=h||{};var l={pub:n.pub,priv:n.priv,epub:h.epub,epriv:h.epriv};if(e)try{e(l)}catch(v){console.log(v)}return l}catch(v){if(console.log(v),t.err=v,t.throw)throw v;e&&e();return}}),w.exports=t.pair})(i,"./pair"),i(function(w){var t=i("./root"),r=i("./shim"),e=i("./settings"),o=i("./sha256"),u;t.sign=t.sign||(async(n,h,l,v)=>{try{if(v=v||{},!(h||v).priv){if(!t.I)throw"No signing key.";h=await t.I(null,{what:n,how:"sign",why:v.why})}if(u===n)throw"`undefined` not allowed.";var d=await e.parse(n),p=v.check=v.check||d;if(t.verify&&(t.opt.check(p)||p&&p.s&&p.m)&&u!==await t.verify(p,h)){var s=await e.parse(p);if(v.raw||(s="SEA"+await r.stringify(s)),l)try{l(s)}catch(S){console.log(S)}return s}var f=h.pub,m=h.priv,A=e.jwk(f,m),c=await o(d),a=await(r.ossl||r.subtle).importKey("jwk",A,{name:"ECDSA",namedCurve:"P-256"},!1,["sign"]).then(_=>(r.ossl||r.subtle).sign({name:"ECDSA",hash:{name:"SHA-256"}},_,new Uint8Array(c))),s={m:d,s:r.Buffer.from(a,"binary").toString(v.encode||"base64")};if(v.raw||(s="SEA"+await r.stringify(s)),l)try{l(s)}catch(_){console.log(_)}return s}catch(_){if(console.log(_),t.err=_,t.throw)throw _;l&&l();return}}),w.exports=t.sign})(i,"./sign"),i(function(w){var t=i("./root"),r=i("./shim"),e=i("./settings"),o=i("./sha256"),u;t.verify=t.verify||(async(l,v,d,p)=>{try{var f=await e.parse(l);if(v===!1){var m=await e.parse(f.m);if(d)try{d(m)}catch(O){console.log(O)}return m}p=p||{};var A=v.pub||v,c=t.opt.slow_leak?await t.opt.slow_leak(A):await(r.ossl||r.subtle).importKey("jwk",e.jwk(A),{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]),a=await o(f.m),s,_,S,T;try{if(s=r.Buffer.from(f.s,p.encode||"base64"),_=new Uint8Array(s),S=await(r.ossl||r.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},c,_,new Uint8Array(a)),!S)throw"Signature did not match."}catch{if(t.opt.fallback)return await t.opt.fall_verify(l,v,d,p)}var j=S?await e.parse(f.m):u;if(d)try{d(j)}catch(O){console.log(O)}return j}catch(O){if(console.log(O),t.err=O,t.throw)throw O;d&&d();return}}),w.exports=t.verify;var n={};t.opt.slow_leak=l=>{if(n[l])return n[l];var v=e.jwk(l);return n[l]=(r.ossl||r.subtle).importKey("jwk",v,{name:"ECDSA",namedCurve:"P-256"},!1,["verify"]),n[l]};var h=t.opt;t.opt.fall_verify=async function(l,v,d,p,f){if(f===t.opt.fallback)throw"Signature did not match";f=f||1;var m=l||"";l=t.opt.unpack(l)||l;var A=await e.parse(l),c=v.pub||v,a=await t.opt.slow_leak(c),s=f<=t.opt.fallback?r.Buffer.from(await r.subtle.digest({name:"SHA-256"},new r.TextEncoder().encode(await e.parse(A.m)))):await o(A.m),_,S,T;try{if(_=r.Buffer.from(A.s,p.encode||"base64"),S=new Uint8Array(_),T=await(r.ossl||r.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},a,S,new Uint8Array(s)),!T)throw"Signature did not match."}catch{try{_=r.Buffer.from(A.s,"utf8"),S=new Uint8Array(_),T=await(r.ossl||r.subtle).verify({name:"ECDSA",hash:{name:"SHA-256"}},a,S,new Uint8Array(s))}catch{if(!T)throw"Signature did not match."}}var j=T?await e.parse(A.m):u;if(h.fall_soul=m["#"],h.fall_key=m["."],h.fall_val=l,h.fall_state=m[">"],d)try{d(j)}catch(O){console.log(O)}return j},t.opt.fallback=2})(i,"./verify"),i(function(w){var t=i("./shim"),r=i("./settings"),e=i("./sha256");const o=async(u,n,h)=>{const l=u+(n||t.random(8)).toString("utf8"),v=t.Buffer.from(await e(l),"binary"),d=r.keyToJwk(v);return await t.subtle.importKey("jwk",d,{name:"AES-GCM"},!1,["encrypt","decrypt"])};w.exports=o})(i,"./aeskey"),i(function(w){var t=i("./root"),r=i("./shim");i("./settings");var e=i("./aeskey"),o;t.encrypt=t.encrypt||(async(u,n,h,l)=>{try{l=l||{};var v=(n||l).epriv||n;if(o===u)throw"`undefined` not allowed.";if(!v){if(!t.I)throw"No encryption key.";n=await t.I(null,{what:u,how:"encrypt",why:l.why}),v=n.epriv||n}var d=typeof u=="string"?u:await r.stringify(u),p={s:r.random(9),iv:r.random(15)},f=await e(v,p.s,l).then(A=>r.subtle.encrypt({name:l.name||"AES-GCM",iv:new Uint8Array(p.iv)},A,new r.TextEncoder().encode(d))),m={ct:r.Buffer.from(f,"binary").toString(l.encode||"base64"),iv:p.iv.toString(l.encode||"base64"),s:p.s.toString(l.encode||"base64")};if(l.raw||(m="SEA"+await r.stringify(m)),h)try{h(m)}catch(A){console.log(A)}return m}catch(A){if(console.log(A),t.err=A,t.throw)throw A;h&&h();return}}),w.exports=t.encrypt})(i,"./encrypt"),i(function(w){var t=i("./root"),r=i("./shim"),e=i("./settings"),o=i("./aeskey");t.decrypt=t.decrypt||(async(u,n,h,l)=>{try{l=l||{};var v=(n||l).epriv||n;if(!v){if(!t.I)throw"No decryption key.";n=await t.I(null,{what:u,how:"decrypt",why:l.why}),v=n.epriv||n}var d=await e.parse(u),p,f,m;try{p=r.Buffer.from(d.s,l.encode||"base64"),f=r.Buffer.from(d.iv,l.encode||"base64"),m=r.Buffer.from(d.ct,l.encode||"base64");var A=await o(v,p,l).then(a=>r.subtle.decrypt({name:l.name||"AES-GCM",iv:new Uint8Array(f),tagLength:128},a,new Uint8Array(m)))}catch{if(l.encode==="utf8")throw"Could not decrypt";if(t.opt.fallback)return l.encode="utf8",await t.decrypt(u,n,h,l)}var c=await e.parse(new r.TextDecoder("utf8").decode(A));if(h)try{h(c)}catch(a){console.log(a)}return c}catch(a){if(console.log(a),t.err=a,t.throw)throw a;h&&h();return}}),w.exports=t.decrypt})(i,"./decrypt"),i(function(w){var t=i("./root"),r=i("./shim");i("./settings"),t.secret=t.secret||(async(o,u,n,h)=>{try{if(h=h||{},!u||!u.epriv||!u.epub){if(!t.I)throw"No secret mix.";u=await t.I(null,{what:o,how:"secret",why:h.why})}var l=o.epub||o,v=u.epub,d=u.epriv,p=r.ossl||r.subtle,f=e(l),m=Object.assign({public:await p.importKey(...f,!0,[])},{name:"ECDH",namedCurve:"P-256"}),A=e(v,d),c=await p.importKey(...A,!1,["deriveBits"]).then(async s=>{var _=await p.deriveBits(m,s,256),S=new Uint8Array(_),T=await p.importKey("raw",S,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]);return p.exportKey("jwk",T).then(({k:j})=>j)}),a=c;if(n)try{n(a)}catch(s){console.log(s)}return a}catch(s){if(console.log(s),t.err=s,t.throw)throw s;n&&n();return}});var e=(o,u)=>{var[n,h]=o.split("."),l=u?{d:u}:{};return["jwk",Object.assign(l,{x:n,y:h,kty:"EC",crv:"P-256",ext:!0}),{name:"ECDH",namedCurve:"P-256"}]};w.exports=t.secret})(i,"./secret"),i(function(w){var t=i("./root");t.certify=t.certify||(async(r,e={},o,u,n={})=>{try{if(console.log("SEA.certify() is an early experimental community supported method that may change API behavior without warning in any future version."),r=(()=>{var a=[];if(r){if((typeof r=="string"||Array.isArray(r))&&r.indexOf("*")>-1)return"*";if(typeof r=="string")return r;if(Array.isArray(r)){if(r.length===1&&r[0])return typeof r[0]=="object"&&r[0].pub?r[0].pub:typeof r[0]=="string"?r[0]:null;r.map(s=>{typeof s=="string"?a.push(s):typeof s=="object"&&s.pub&&a.push(s.pub)})}return typeof r=="object"&&r.pub?r.pub:a.length>0?a:null}})(),!r)return console.log("No certificant found.");const l=n.expiry&&(typeof n.expiry=="number"||typeof n.expiry=="string")?parseFloat(n.expiry):null,v=(e||{}).read?e.read:null,d=(e||{}).write?e.write:typeof e=="string"||Array.isArray(e)||e["+"]||e["#"]||e["."]||e["="]||e["*"]||e[">"]||e["<"]?e:null,p=(n||{}).block||(n||{}).blacklist||(n||{}).ban||{},f=p.read&&(typeof p.read=="string"||(p.read||{})["#"])?p.read:null,m=typeof p=="string"?p:p.write&&(typeof p.write=="string"||p.write["#"])?p.write:null;if(!v&&!d)return console.log("No policy found.");const A=JSON.stringify(F(F(F(F(F({c:r},l?{e:l}:{}),v?{r:v}:{}),d?{w:d}:{}),f?{rb:f}:{}),m?{wb:m}:{}));var h=await t.sign(A,o,null,{raw:1});if(n.raw||(h="SEA"+JSON.stringify(h)),u)try{u(h)}catch(a){console.log(a)}return h}catch(l){if(t.err=l,t.throw)throw l;u&&u();return}}),w.exports=t.certify})(i,"./certify"),i(function(w){var t=i("./shim"),r=i("./root");r.work=i("./work"),r.sign=i("./sign"),r.verify=i("./verify"),r.encrypt=i("./encrypt"),r.decrypt=i("./decrypt"),r.certify=i("./certify"),r.random=r.random||t.random,r.Buffer=r.Buffer||i("./buffer"),r.keyid=r.keyid||(async e=>{try{const o=t.Buffer.concat(e.replace(/-/g,"+").replace(/_/g,"/").split(".").map(l=>t.Buffer.from(l,"base64"))),u=t.Buffer.concat([t.Buffer.from([153,o.length/256,o.length%256]),o]),n=await sha1hash(u),h=t.Buffer.from(n,"binary");return h.toString("hex",h.length-8)}catch(o){throw console.log(o),o}}),((r.window||{}).GUN||{}).SEA=r,w.exports=r})(i,"./sea"),i(function(w){var t=i("./sea"),r,e;t.window?r=t.window.GUN||{chain:{}}:r=i((e+""==typeof $?".":"")+"./gun",1),t.GUN=r;function o(n){this._={$:this}}o.prototype=function(){function n(){}return n.prototype=r.chain,new n}(),o.prototype.constructor=o,r.chain.user=function(n){var h=this,l=h.back(-1),v;if(n)return n=t.opt.pub((n._||"")["#"])||n,l.get("~"+n);if(v=l.back("user"))return v;var l=l._,d=l,p=d.opt.uuid||u;return(d=(v=d.user=h.chain(new o))._).opt={},d.opt.uuid=function(f){var m=p(),A=l.user;return!A||!(A=A.is)||!(A=A.pub)||(m="~"+A+"/"+m,f&&f.call&&f(null,m)),m},v};function u(){return r.state().toString(36).replace(".","")}r.User=o,o.GUN=r,o.SEA=r.SEA=t,w.exports=o})(i,"./user"),i(function(w){var t,r=""+t!=typeof window?window.Gun||{chain:{}}:i((""+t==typeof $?".":"")+"./gun",1);r.chain.then=function(e,o){var u=this,n=new Promise(function(h,l){u.once(h,o)});return e?n.then(e):n}})(i,"./then"),i(function(w){var t=i("./user"),r=t.SEA,e=t.GUN,o=function(){};t.prototype.create=function(...u){var n=typeof u[0]=="object"&&(u[0].pub||u[0].epub)?u[0]:typeof u[1]=="object"&&(u[1].pub||u[1].epub)?u[1]:null,h=n&&(n.pub||n.epub)?n.pub:typeof u[0]=="string"?u[0]:null,l=n&&(n.pub||n.epub)?n:h&&typeof u[1]=="string"?u[1]:null,v=u.filter(a=>typeof a=="function")[0]||null,d=u&&u.length>1&&typeof u[u.length-1]=="object"?u[u.length-1]:{},p=this,f=p._,m=p.back(-1);if(v=v||o,d=d||{},d.check!==!1){var A;if(h||(A="No user."),(l||"").length<8&&(A="Password too short!"),A)return v({err:e.log(A)}),p}if(f.ing)return(v||o)({err:e.log("User is already being created or authenticated!"),wait:!0}),p;f.ing=!0;var c={};return c.a=function(a){if(c.pubs=a,a&&!d.already){var s={err:e.log("User already created!")};f.ing=!1,(v||o)(s),p.leave();return}c.salt=String.random(64),r.work(l,c.salt,c.b)},c.b=function(a){c.proof=a,n?c.c(n):r.pair(c.c)},c.c=function(a){var s;c.pair=a||{},(s=f.root.user)&&(s._.sea=a,s.is={pub:a.pub,epub:a.epub,alias:h}),c.data={pub:a.pub},c.d()},c.d=function(){c.data.alias=h,c.e()},c.e=function(){c.data.epub=c.pair.epub,r.encrypt({priv:c.pair.priv,epriv:c.pair.epriv},c.proof,c.f,{raw:1})},c.f=function(a){c.data.auth=JSON.stringify({ek:a,s:c.salt}),c.g(c.data.auth)},c.g=function(a){var s;c.data.auth=c.data.auth||a,m.get(s="~"+c.pair.pub).put(c.data).on(c.h);var _={};_[s]={"#":s},m.get("~@"+h).put(_).get(s).on(c.i)},c.h=function(a,s,_,S){S.off(),c.h.ok=1,c.i()},c.i=function(a,s,_,S){S&&(c.i.ok=1,S.off()),!(!c.h.ok||!c.i.ok)&&(f.ing=!1,v({ok:0,pub:c.pair.pub}),o===v&&(n?p.auth(n):p.auth(h,l)))},m.get("~@"+h).once(c.a),p},t.prototype.leave=function(u,n){var h=this,l=h.back(-1)._.user;if(l&&(delete l.is,delete l._.is,delete l._.sea),r.window)try{var v={};v=window.sessionStorage,delete v.recall,delete v.pair}catch{}return h}})(i,"./create"),i(function(w){var t=i("./user"),r=t.SEA,e=t.GUN,o=function(){};t.prototype.auth=function(...n){var h=typeof n[0]=="object"&&(n[0].pub||n[0].epub)?n[0]:typeof n[1]=="object"&&(n[1].pub||n[1].epub)?n[1]:null,l=!h&&typeof n[0]=="string"?n[0]:null,v=l&&typeof n[1]=="string"?n[1]:null,d=n.filter(s=>typeof s=="function")[0]||null,p=n&&n.length>1&&typeof n[n.length-1]=="object"?n[n.length-1]:{},f=this,m=f._,A=f.back(-1);if(m.ing)return(d||o)({err:e.log("User is already being created or authenticated!"),wait:!0}),f;m.ing=!0;var c={},a;return c.a=function(s){if(!s)return c.b();if(!s.pub){var _=[];return Object.keys(s).forEach(function(S){S!="_"&&_.push(s[S])}),c.b(_)}if(c.name)return c.f(s);c.c((c.data=s).auth)},c.b=function(s){var _=(c.list=(c.list||[]).concat(s||[])).shift();if(a===_)return c.name?c.err("Your user account is not published for dApps to access, please consider syncing it online, or allowing local access by adding your device as a peer."):c.err("Wrong user or password.");A.get(_).once(c.a)},c.c=function(s){if(a===s)return c.b();if(typeof s=="string")return c.c(u(s));r.work(v,(c.auth=s).s,c.d,c.enc)},c.d=function(s){r.decrypt(c.auth.ek,s,c.e,c.enc)},c.e=function(s){if(a===s)return c.enc?(c.enc=null,c.b()):(c.enc={encode:"utf8"},c.c(c.auth));c.half=s,c.f(c.data)},c.f=function(s){var _=c.half||{},S=c.data||{};c.g(c.lol={pub:s.pub||S.pub,epub:s.epub||S.epub,priv:s.priv||_.priv,epriv:s.epriv||_.epriv})},c.g=function(s){if(!s||!s.pub||!s.epub)return c.b();c.pair=s;var _=A._.user,S=_._;S.tag;var T=S.opt;S=_._=A.get("~"+s.pub)._,S.opt=T,_.is={pub:s.pub,epub:s.epub,alias:l||s.pub},S.sea=c.pair,m.ing=!1;try{v&&a==(u(m.root.graph["~"+s.pub].auth)||"")[":"]&&(p.shuffle=p.change=v)}catch{}if(p.change?c.z():(d||o)(S),r.window&&(f.back("user")._.opt||p).remember)try{var j={};j=window.sessionStorage,j.recall=!0,j.pair=JSON.stringify(s)}catch{}try{A._.tag.auth?A._.on("auth",S):setTimeout(function(){A._.on("auth",S)},1)}catch(O){e.log("Your 'auth' callback crashed with:",O)}},c.z=function(){c.salt=String.random(64),r.work(p.change,c.salt,c.y)},c.y=function(s){r.encrypt({priv:c.pair.priv,epriv:c.pair.epriv},s,c.x,{raw:1})},c.x=function(s){c.w(JSON.stringify({ek:s,s:c.salt}))},c.w=function(s){if(p.shuffle){console.log("migrate core account from UTF8 & shuffle");var _={};Object.keys(c.data).forEach(function(S){_[S]=c.data[S]}),delete _._,_.auth=s,A.get("~"+c.pair.pub).put(_)}A.get("~"+c.pair.pub).get("auth").put(s,d||o)},c.err=function(s){var _={err:e.log(s||"User cannot be found!")};m.ing=!1,(d||o)(_)},c.plugin=function(s){if(!(c.name=s))return c.err();var _=[s];s[0]!=="~"&&(_[1]="~"+s,_[2]="~@"+s),c.b(_)},h?c.g(h):l?A.get("~@"+l).once(c.a):!l&&!v&&r.name(c.plugin),f};function u(n){if(typeof n!="string")return n;try{n=JSON.parse(n)}catch{n={}}return n}})(i,"./auth"),i(function(w){var t=i("./user"),r=t.SEA;t.GUN,t.prototype.recall=function(e,o){var u=this,n=u.back(-1);if(e=e||{},e&&e.sessionStorage){if(r.window)try{var h={};h=window.sessionStorage,h&&(n._.opt.remember=!0,(u.back("user")._.opt||e).remember=!0,(h.recall||h.pair)&&n.user().auth(JSON.parse(h.pair),o))}catch{}return u}return u}})(i,"./recall"),i(function(w){var t=i("./user"),r=t.SEA,e=t.GUN,o=function(){};t.prototype.pair=function(){var u=this,n;try{n=new Proxy({DANGER:"\u2620"},{get:function(h,l,v){if(!(!u.is||!(u._||"").sea))return u._.sea[l]}})}catch{}return n},t.prototype.delete=async function(u,n,h){console.log("user.delete() IS DEPRECATED AND WILL BE MOVED TO A MODULE!!!");var l=this;l.back(-1);var v=l.back("user");try{v.auth(u,n,function(d){var p=(v.is||{}).pub;v.map().once(function(){this.put(null)}),v.leave(),(h||o)({ok:0})})}catch(d){e.log("User.delete failed! Error:",d)}return l},t.prototype.alive=async function(){console.log("user.alive() IS DEPRECATED!!!");const u=this.back(-1);try{return await authRecall(u),u._.user._}catch{const h="No session!";throw e.log(h),{err:h}}},t.prototype.trust=async function(u){console.log("`.trust` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!"),e.is(u)&&u.get("pub").get((n,h)=>{console.log(n,h)}),u.get("trust").get(path).put(theirPubkey)},t.prototype.grant=function(u,n){console.log("`.grant` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!");var h=this,l=h.back(-1).user(),v=l._.sea,d="";return h.back(function(p){p.is||(d+=p.get||"")}),async function(){var p,f=await l.get("grant").get(v.pub).get(d).then();f=await r.decrypt(f,v),f||(f=r.random(16).toString(),p=await r.encrypt(f,v),l.get("grant").get(v.pub).get(d).put(p));var m=u.get("pub").then(),A=u.get("epub").then();m=await m,A=await A;var c=await r.secret(A,v);p=await r.encrypt(f,c),l.get("grant").get(m).get(d).put(p,n)}(),h},t.prototype.secret=function(u,n){console.log("`.secret` API MAY BE DELETED OR CHANGED OR RENAMED, DO NOT USE!");var h=this,l=h.back(-1).user(),v=l.pair(),d="";return h.back(function(p){p.is||(d+=p.get||"")}),async function(){var p,f=await l.get("trust").get(v.pub).get(d).then();f=await r.decrypt(f,v),f||(f=r.random(16).toString(),p=await r.encrypt(f,v),l.get("trust").get(v.pub).get(d).put(p)),p=await r.encrypt(u,f),h.put(p,n)}(),h},w.exports=t})(i,"./share"),i(function(w){var t=i("./sea"),r=i("./settings"),e=function(){},o,u=""+o!=typeof window?window.Gun||{on:e}:i((""+o==typeof $?".":"")+"./gun",1);u.on("opt",function(f){f.sea||(f.sea={own:{}},f.on("put",n,f)),this.to.next(f)});function n(f){var m=this,A=m.as,c=f.put,a=c["#"],s=c["."],_=c[":"],S=c[">"],T=f["#"],j;if(!(!a||!s)){if((f._||"").faith&&(A.opt||"").faith&&typeof f._=="function"){t.opt.pack(c,function(k){t.verify(k,!1,function(G){c["="]=t.opt.unpack(G),m.to.next(f)})});return}var O=function(k){A.on("in",{"@":T,err:f.err=k})};if((f._||"").DBG&&((f._||"").DBG.c=+new Date),0<=a.indexOf("<?")&&(j=parseFloat(a.split("<?")[1]||""),j&&S<u.state()-j*1e3)){(j=f._)&&j.stun&&j.stun--;return}if(a==="~@"){n.alias(m,f,_,s,a,A,O);return}if(a.slice(0,2)==="~@"){n.pubs(m,f,_,s,a,A,O);return}if(j=t.opt.pub(a)){n.pub(m,f,_,s,a,A,O,A.user||"",j);return}if(0<=a.indexOf("#")){n.hash(m,f,_,s,a,A,O);return}n.any(m,f,_,s,a,A,O,A.user||"")}}n.hash=function(f,m,A,c,a,s,_){t.work(A,null,function(S){if(S&&S===c.split("#").slice(-1)[0])return f.to.next(m);_("Data hash not same as hash!")},{name:"SHA-256"})},n.alias=function(f,m,A,c,a,s,_){if(!A)return _("Data must exist!");if("~@"+c===l(A))return f.to.next(m);_("Alias not same!")},n.pubs=function(f,m,A,c,a,s,_){if(!A)return _("Alias must exist!");if(c===l(A))return f.to.next(m);_("Alias not same!")},n.pub=async function(f,m,A,c,a,s,_,S,T){var j;const O=await r.parse(A)||{},k=(G,y,b)=>{if(G.m&&G.s&&y&&T)return t.verify(G,T,x=>{if(o!==x&&o!==x.e&&m.put[">"]&&m.put[">"]>parseFloat(x.e))return _("Certificate expired.");if(o!==x&&x.c&&x.w&&(x.c===y||x.c.indexOf("*")>-1)){let B=a.indexOf("/")>-1?a.replace(a.substring(0,a.indexOf("/")+1),""):"";String.match=String.match||u.text.match;const D=Array.isArray(x.w)?x.w:typeof x.w=="object"||typeof x.w=="string"?[x.w]:[];for(const N of D)if(String.match(B,N["#"])&&String.match(c,N["."])||!N["."]&&String.match(B,N["#"])||!N["#"]&&String.match(c,N["."])||String.match(B?B+"/"+c:c,N["#"]||N)){if(N["+"]&&N["+"].indexOf("*")>-1&&B&&B.indexOf(y)==-1&&c.indexOf(y)==-1)return _(`Path "${B}" or key "${c}" must contain string "${y}".`);if(x.wb&&(typeof x.wb=="string"||(x.wb||{})["#"])){var E=f.as.root.$.back(-1);return typeof x.wb=="string"&&x.wb.slice(0,1)!=="~"&&(E=E.get("~"+T)),E.get(x.wb).get(y).once(C=>C&&(C===1||C===!0)?_(`Certificant ${y} blocked.`):b(x))}return b(x)}return _("Certificate verification fail.")}})};if(c==="pub"&&"~"+T===a)return A===T?f.to.next(m):_("Account not same!");if((j=S.is)&&j.pub&&!O["*"]&&!O["+"]&&(T===j.pub||T!==j.pub&&((m._.msg||{}).opt||{}).cert)){t.opt.pack(m.put,G=>{t.sign(G,S._.sea,async function(y){if(o===y)return _(t.err||"Signature fail.");if(m.put[":"]={":":j=t.opt.unpack(y.m),"~":y.s},m.put["="]=j,T===S.is.pub){(j=l(A))&&((s.sea.own[j]=s.sea.own[j]||{})[T]=1),JSON.stringifyAsync(m.put[":"],function(b,x){return b?_(b||"Stringify error."):(m.put[":"]=x,f.to.next(m))});return}if(T!==S.is.pub&&((m._.msg||{}).opt||{}).cert){const b=await r.parse(m._.msg.opt.cert);b&&b.m&&b.s&&k(b,S.is.pub,x=>{m.put[":"]["+"]=b,m.put[":"]["*"]=S.is.pub,JSON.stringifyAsync(m.put[":"],function(E,B){return E?_(E||"Stringify error."):(m.put[":"]=B,f.to.next(m))})})}},{raw:1})});return}t.opt.pack(m.put,G=>{t.verify(G,O["*"]||T,function(y){var b;if(y=t.opt.unpack(y),o===y)return _("Unverified data.");if((b=l(y))&&T===t.opt.pub(b)&&((s.sea.own[b]=s.sea.own[b]||{})[T]=1),O["+"]&&O["+"].m&&O["+"].s&&O["*"])k(O["+"],O["*"],x=>(m.put["="]=y,f.to.next(m)));else return m.put["="]=y,f.to.next(m)})})},n.any=function(f,m,A,c,a,s,_,S){if(s.opt.secure)return _("Soul missing public key at '"+c+"'.");s.on("secure",function(T){if(this.off(),!s.opt.secure)return f.to.next(T);_("Data cannot be changed.")}).on.on("secure",m)};var h=u.valid,l=function(f,m){return typeof(m=h(f))=="string"&&m};(u.state||"").ify;var v=/[^\w_-]/;t.opt.pub=function(f){if(!!f&&(f=f.split("~"),!(!f||!(f=f[1]))&&(f=f.split(v).slice(0,2),!(!f||f.length!=2)&&(f[0]||"")[0]!=="@")))return f=f.slice(0,2).join("."),f},t.opt.stringy=function(f){},t.opt.pack=function(f,m,A,c,a){var s,_;if(t.opt.check(f))return m(f);f&&f["#"]&&f["."]&&f[">"]&&(s=f[":"],_=1),JSON.parseAsync(_?s:f,function(S,T){var j=o!==(T||"")[":"]&&(T||"")["~"];if(!j){m(f);return}m({m:{"#":a||f["#"],".":A||f["."],":":(T||"")[":"],">":f[">"]||u.state.is(c,A)},s:j})})};var d=t.opt;t.opt.unpack=function(f,m,A){var c;if(o!==f){if(f&&o!==(c=f[":"]))return c;if(m=m||d.fall_key,!A&&d.fall_val&&(A={},A[m]=d.fall_val),!(!m||!A)){if(f===A[m]||!t.opt.check(A[m]))return f;var a=A&&A._&&A._["#"]||d.fall_soul,s=u.state.is(A,m)||d.fall_state;if(f&&f.length===4&&a===f[0]&&m===f[1]&&p(s)===p(f[3]))return f[2];if(s<t.opt.shuffle_attack)return f}}},t.opt.shuffle_attack=15463296e5;var p=Math.floor})(i,"./index")})()})(Xt);var zt={exports:{}};(function(g){(function(){function i(w,t){return t?st(w):w.slice?i[r(w)]:function(e,o){w(e={exports:{}}),i[r(o)]=e.exports};function r(e){return e.split("/").slice(-1).toString().replace(".js","")}}var $=g;i(function(w){typeof window!="undefined"&&(w.window=window);var t=w.window||w,r=t.AXE||function(){};(r.window=w.window)&&(r.window.AXE=r);try{typeof $!="undefined"&&($.exports=r)}catch{}w.exports=r})(i,"./root"),i(function(w){var t=i("./root"),r=(t.window||"").Gun||i("./gun",1);if((r.AXE=t).GUN=t.Gun=r,!r.window)try{i("./lib/axe",1)}catch{}r.on("opt",function(o){e(o),this.to.next(o)});function e(o){if(!o.axe){var u=o.opt,n=u.peers;if(u.axe!==!1&&!(typeof process!="undefined"&&""+(process.env||"").AXE=="false")&&!!r.window){o.axe={};var h,l;h=n[l="http://localhost:8765/gun"]=n[l]||{},h.id=h.url=l,h.retry=h.retry||0,console.log("AXE enabled: Trying to find network via (1) local peer (2) last used peers (3) hard coded peers."),console.log("Warning: AXE alpha became super slow & laggy, now in testing only mode!");var v=JSON.parse((localStorage||"")[(u.file||"")+"axe/"]||null)||{};Object.keys(v.peers||"").forEach(function(p){h=n[l=p]=n[l]||{},h.id=h.url=l}),h=n[l="https://ovh.era.eco/gun"]=n[l]||{},h.id=h.url=l;var d=u.mesh=u.mesh||r.Mesh(o);d.way=function(p){if(o.$===p.$||(p._||"").via){d.say(p,u.peers);return}var f=(p.$||"")._;if(!f){d.say(p,u.peers);return}if(p.get){if(f.axe)return;f.axe={}}d.say(p,u.peers)}}}}w.exports=t})(i,"./axe")})()})(zt);export{he as A,jt as B,je as C,Qt as D,te as E,ee as F,Zt as G,Ct as H,W as I,ce as J,oe as K,L,Te as M,ge as N,be as O,le as P,Tt as Q,Yt as R,Ae as S,Pt as a,ue as b,ae as c,It as d,Ut as e,ne as f,Kt as g,se as h,Se as i,ke as j,re as k,ie as l,xe as m,fe as n,Wt as o,_e as p,me as q,de as r,$t as s,nt as t,we as u,qt as v,ve as w,mt as x,ye as y,pe as z};
